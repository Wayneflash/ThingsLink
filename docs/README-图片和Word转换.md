# Markdown转Word文档使用指南

## 📋 功能说明

本工具可以将Markdown文档（含图片）转换为Word文档，方便编辑和分享。

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install python-docx markdown
```

或者使用批处理脚本（会自动安装）：

```bash
scripts\md-to-word.bat
```

### 2. 准备图片

将图片放在 `docs/images/` 目录下（如果目录不存在，请先创建）：

```
docs/
  ├── images/
  │   ├── 截图1-数据概览大屏.png
  │   ├── 截图2-设备详情页.png
  │   └── ...
  └── 产品宣传文档.md
```

### 3. 在Markdown中引用图片

在Markdown文档中使用相对路径引用图片：

```markdown
![数据概览大屏](images/截图1-数据概览大屏.png)
```

或者使用截图标记（脚本会自动识别）：

```markdown
现在每天早上登录平台查看数据。【截图1：数据概览大屏】
```

### 4. 转换为Word

**方法一：使用批处理脚本（推荐）**

```bash
scripts\md-to-word.bat docs\产品宣传文档.md
```

**方法二：使用Python脚本**

```bash
python scripts\md-to-word.py docs\产品宣传文档.md
```

**方法三：指定输出文件**

```bash
python scripts\md-to-word.py docs\产品宣传文档.md output\产品宣传文档.docx
```

## 📝 支持的Markdown特性

- ✅ 标题（H1-H4）
- ✅ 段落文本
- ✅ 图片（自动插入Word）
- ✅ 表格
- ✅ 列表（有序/无序）
- ✅ 代码块
- ✅ 截图标记（【截图1：描述】）
- ✅ 分隔线

## 🎨 格式说明

- **字体**：默认使用"微软雅黑"
- **字号**：正文11pt，标题自动调整
- **图片**：自动居中，宽度6英寸
- **截图标记**：会显示为蓝色占位符，方便后续替换

## 💡 使用建议

### 图片处理流程

1. **准备图片**：将截图保存到 `docs/images/` 目录
2. **命名规范**：使用有意义的文件名，如 `截图1-数据概览大屏.png`
3. **在Markdown中标记**：使用 `【截图1：数据概览大屏】` 标记位置
4. **转换为Word**：运行脚本生成Word文档
5. **替换图片**：在Word中手动替换截图占位符为实际图片

### 截图标记格式

```markdown
【截图1：数据概览大屏】
【截图2：设备详情页实时数据】
【截图3：能耗趋势分析页面】
```

脚本会自动识别这些标记，并在Word中创建占位符。

## ⚠️ 注意事项

1. **图片路径**：使用相对路径，相对于Markdown文件所在目录
2. **图片格式**：支持 PNG、JPG、JPEG 等常见格式
3. **中文支持**：确保Markdown文件使用UTF-8编码
4. **文件大小**：图片文件过大可能影响转换速度

## 🔧 故障排除

### 问题1：提示"缺少必要的Python库"

**解决方案**：
```bash
pip install python-docx markdown
```

### 问题2：图片无法显示

**检查项**：
- 图片路径是否正确（相对路径）
- 图片文件是否存在
- 图片文件是否损坏

### 问题3：中文显示乱码

**解决方案**：
- 确保Markdown文件使用UTF-8编码
- 确保系统已安装"微软雅黑"字体

## 📞 更多帮助

如有问题，请查看脚本源码：`scripts/md-to-word.py`
