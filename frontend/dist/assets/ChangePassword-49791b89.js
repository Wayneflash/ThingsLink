import{_ as C,u as E,r as w,b as B,c as n,o as I,d as N,e as o,f as a,w as r,h as _,Y as S,p as g,Z as k,E as v,Q as R}from"./index-6b170f93.js";import{c as T}from"./auth-8bc2b470.js";const q={class:"change-password-page"},z={class:"content-container"},M={class:"form-actions"},U={__name:"ChangePassword",setup(Q){const P=E(),d=w(null),i=w(!1),t=B({newPassword:"",confirmPassword:""}),y={newPassword:[{required:!0,validator:(l,e,s)=>{e?e.length<6?s(new Error("密码长度至少6位")):s():s(new Error("请输入新密码"))},trigger:"blur"}],confirmPassword:[{required:!0,validator:(l,e,s)=>{e?e!==t.newPassword?s(new Error("两次输入的密码不一致")):s():s(new Error("请确认新密码"))},trigger:"blur"}]},h=async()=>{var l,e;if(d.value)try{await d.value.validate(),i.value=!0,await T({newPassword:t.newPassword}),v.success("密码修改成功，请使用新密码重新登录"),R.confirm("密码修改成功！为了安全起见，建议您重新登录。是否立即退出登录？","提示",{confirmButtonText:"退出登录",cancelButtonText:"稍后退出",type:"success"}).then(()=>{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userInfo"),localStorage.removeItem("menus"),P.push("/login")}).catch(()=>{c()})}catch(s){if(s.message&&s.message.includes("validate"))return;console.error("修改密码失败:",s),v.error(((e=(l=s.response)==null?void 0:l.data)==null?void 0:e.message)||s.message||"密码修改失败")}finally{i.value=!1}},c=()=>{var l;t.newPassword="",t.confirmPassword="",(l=d.value)==null||l.clearValidate()};return(l,e)=>{const s=n("el-input"),u=n("el-form-item"),p=n("el-icon"),f=n("el-button"),x=n("el-form"),V=n("el-alert"),b=n("el-card");return I(),N("div",q,[e[9]||(e[9]=o("div",{class:"page-header"},[o("h2",{class:"page-title"},"🔐 修改密码")],-1)),o("div",z,[a(b,{class:"password-card"},{header:r(()=>[...e[2]||(e[2]=[o("div",{class:"card-header"},[o("span",{class:"card-title"},"密码修改")],-1)])]),default:r(()=>[a(x,{ref_key:"formRef",ref:d,model:t,rules:y,"label-width":"120px",class:"password-form",autocomplete:"off"},{default:r(()=>[a(u,{label:"新密码",prop:"newPassword"},{default:r(()=>[a(s,{modelValue:t.newPassword,"onUpdate:modelValue":e[0]||(e[0]=m=>t.newPassword=m),type:"password","show-password":"",placeholder:"请输入新密码（至少6位）",maxlength:"50",clearable:"",autocomplete:"new-password"},null,8,["modelValue"]),e[3]||(e[3]=o("div",{class:"form-tip"},"密码长度至少6位，建议使用字母、数字和特殊字符组合",-1))]),_:1}),a(u,{label:"确认新密码",prop:"confirmPassword"},{default:r(()=>[a(s,{modelValue:t.confirmPassword,"onUpdate:modelValue":e[1]||(e[1]=m=>t.confirmPassword=m),type:"password","show-password":"",placeholder:"请再次输入新密码",maxlength:"50",clearable:"",autocomplete:"new-password"},null,8,["modelValue"]),e[4]||(e[4]=o("div",{class:"form-tip"},"请再次输入新密码以确认",-1))]),_:1}),a(u,null,{default:r(()=>[o("div",M,[a(f,{type:"primary",onClick:h,loading:i.value,size:"large"},{default:r(()=>[a(p,{style:{"margin-right":"6px"}},{default:r(()=>[a(_(S))]),_:1}),e[5]||(e[5]=g(" 保存修改 ",-1))]),_:1},8,["loading"]),a(f,{onClick:c,size:"large"},{default:r(()=>[a(p,{style:{"margin-right":"6px"}},{default:r(()=>[a(_(k))]),_:1}),e[6]||(e[6]=g(" 重置 ",-1))]),_:1})])]),_:1})]),_:1},8,["model"]),a(V,{type:"warning",closable:!1,class:"security-alert"},{title:r(()=>[...e[7]||(e[7]=[o("strong",null,"安全提示",-1)])]),default:r(()=>[e[8]||(e[8]=o("div",{class:"alert-content"},[o("p",null,"1. 密码修改成功后，请使用新密码重新登录"),o("p",null,"2. 建议定期更换密码，提高账户安全性"),o("p",null,"3. 不要使用过于简单的密码（如123456、password等）"),o("p",null,"4. 密码修改后，请妥善保管，避免泄露")],-1))]),_:1})]),_:1})])])}}},D=C(U,[["__scopeId","data-v-1163f0bc"]]);export{D as default};
