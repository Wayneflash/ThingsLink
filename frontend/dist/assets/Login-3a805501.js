import{_ as z,u as M,a as N,r as Y,b as R,c as g,o as c,d as u,e as t,F as v,f as y,g as l,w as n,h as B,n as w,i as b,j as F,k as Q,l as q,t as x,m as C,p as E,q as G,s as A,v as J,x as K,E as m}from"./index-62e02c83.js";import{l as O}from"./auth-f5c64bdd.js";const P={class:"login-container"},U={class:"bg-decoration"},j={class:"connection-nodes"},H={class:"data-packages"},W={class:"connection-lines",viewBox:"0 0 1920 1080",preserveAspectRatio:"none"},Z=["d"],ee={class:"login-left"},te={class:"login-left-content"},oe={class:"logo-section"},se={class:"logo-icon-wrapper"},le={class:"logo-icon"},ne={class:"feature-list"},ae={class:"feature-icon-wrapper"},re={class:"feature-content"},ie={class:"feature-title"},de={class:"feature-desc"},ce={class:"login-right"},ue={class:"login-form-wrapper"},pe={__name:"Login",setup(fe){const T=M(),S=N(),k=Y(null),_=Y(!1),d=R({username:"",password:""}),V={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},$=[{icon:A,title:"设备实时监控",desc:"全方位设备状态监测与数据采集"},{icon:J,title:"数据智能分析",desc:"AI驱动数据洞察与预测分析"},{icon:K,title:"告警及时通知",desc:"智能预警系统保障设备安全"}],D=[{path:"M200,150 Q400,200 600,180 T1000,200"},{path:"M300,400 Q500,300 800,350 T1200,400"},{path:"M500,600 Q700,500 900,550 T1300,600"},{path:"M150,500 Q350,450 600,500 T1050,550"},{path:"M700,250 Q900,300 1100,280 T1500,300"}],I=a=>{const e=[{top:"8%",left:"12%"},{top:"22%",left:"78%"},{top:"38%",left:"18%"},{top:"52%",left:"72%"},{top:"68%",left:"28%"},{top:"12%",left:"48%"},{top:"28%",left:"58%"},{top:"45%",left:"38%"},{top:"62%",left:"68%"},{top:"18%",left:"32%"},{top:"35%",left:"82%"},{top:"55%",left:"52%"},{top:"75%",left:"62%"},{top:"25%",left:"25%"},{top:"42%",left:"88%"}],s=e[(a-1)%e.length],i=(a-1)*.25;return{top:s.top,left:s.left,animationDelay:`${i}s`}},L=a=>{const e=[{startX:200,startY:150,endX:800,endY:350,duration:4},{startX:400,startY:400,endX:1200,endY:500,duration:5},{startX:600,startY:250,endX:1e3,endY:550,duration:6},{startX:300,startY:500,endX:1100,endY:300,duration:5.5},{startX:500,startY:180,endX:900,endY:450,duration:4.5},{startX:700,startY:350,endX:1300,endY:600,duration:6.5}],s=e[(a-1)%e.length],i=(a-1)*.8;return{"--start-x":`${s.startX}px`,"--start-y":`${s.startY}px`,"--end-x":`${s.endX}px`,"--end-y":`${s.endY}px`,animationDuration:`${s.duration}s`,animationDelay:`${i}s`}},X=async()=>{var a;if(k.value)try{if(!await k.value.validate())return;_.value=!0;const s=await O({username:d.username,password:d.password});if(s){const{token:i,user:p,menus:h}=s;localStorage.setItem("token",i),localStorage.setItem("userInfo",JSON.stringify(p)),localStorage.setItem("menus",JSON.stringify(h||[])),m.success("登录成功"),await new Promise(r=>setTimeout(r,300));const f=S.query.redirect||"/overview",o=localStorage.getItem("token");if(!o){console.error("Token 未保存成功"),m.error("登录状态保存失败，请重新登录");return}console.log("准备跳转到:",f,"Token:",o?"已保存":"未保存");try{await T.replace(f),console.log("路由跳转成功")}catch(r){console.error("路由跳转失败:",r),m.warning("正在跳转..."),window.location.href=f}}else m.error(s.message||"登录失败")}catch(e){console.error("登录失败:",e),e!==!1&&!((a=e.message)!=null&&a.includes("validate"))&&m.error(e.message||"登录失败，请稍后重试")}finally{_.value=!1}};return(a,e)=>{const s=g("el-icon"),i=g("el-input"),p=g("el-form-item"),h=g("el-button"),f=g("el-form");return c(),u("div",P,[t("div",U,[e[5]||(e[5]=t("div",{class:"grid-pattern"},null,-1)),e[6]||(e[6]=t("div",{class:"data-flow"},null,-1)),t("div",j,[(c(),u(v,null,y(15,o=>t("div",{key:o,class:"node",style:w(I(o))},[...e[2]||(e[2]=[t("div",{class:"node-core"},null,-1),t("div",{class:"node-ring"},null,-1)])],4)),64))]),t("div",H,[(c(),u(v,null,y(6,o=>t("div",{key:o,class:"data-package",style:w(L(o))},[...e[3]||(e[3]=[t("div",{class:"package-content"},null,-1)])],4)),64))]),(c(),u("svg",W,[e[4]||(e[4]=t("defs",null,[t("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[t("stop",{offset:"0%",style:{"stop-color":"rgba(102, 126, 234, 0.3)","stop-opacity":"0"}}),t("stop",{offset:"50%",style:{"stop-color":"rgba(102, 126, 234, 0.6)","stop-opacity":"1"}}),t("stop",{offset:"100%",style:{"stop-color":"rgba(118, 75, 162, 0.3)","stop-opacity":"0"}})])],-1)),(c(),u(v,null,y(D,(o,r)=>t("path",{key:r,d:o.path,class:"connection-line",style:w({animationDelay:`${r*.5}s`}),stroke:"url(#lineGradient)",fill:"none","stroke-width":"2"},null,12,Z)),64))]))]),t("div",ee,[t("div",te,[t("div",oe,[t("div",se,[e[7]||(e[7]=t("div",{class:"logo-icon-glow"},null,-1)),e[8]||(e[8]=t("div",{class:"logo-icon-pulse"},null,-1)),t("div",le,[l(s,{size:52},{default:n(()=>[l(b(F))]),_:1})])]),e[9]||(e[9]=t("h1",{class:"logo-title"},"ThingsLink",-1)),e[10]||(e[10]=t("p",{class:"logo-subtitle"},"智慧物联网平台",-1)),e[11]||(e[11]=t("div",{class:"logo-tagline"},"连接万物，智能未来",-1))]),t("div",ne,[(c(),u(v,null,y($,(o,r)=>t("div",{key:r,class:"feature-item",style:w({animationDelay:`${r*.15}s`})},[t("div",ae,[e[12]||(e[12]=t("div",{class:"feature-icon-bg"},null,-1)),l(s,{size:24,class:"feature-icon"},{default:n(()=>[(c(),Q(q(o.icon)))]),_:2},1024)]),t("div",re,[t("div",ie,x(o.title),1),t("div",de,x(o.desc),1)])],4)),64))])])]),t("div",ce,[t("div",ue,[e[13]||(e[13]=t("div",{class:"form-header"},[t("h2",null,"欢迎登录"),t("p",null,"请输入您的账号和密码")],-1)),l(f,{ref_key:"loginFormRef",ref:k,model:d,rules:V,class:"login-form",onKeyup:B(X,["enter"])},{default:n(()=>[l(p,{prop:"username"},{default:n(()=>[l(i,{modelValue:d.username,"onUpdate:modelValue":e[0]||(e[0]=o=>d.username=o),placeholder:"请输入用户名",size:"large",clearable:"",autocomplete:"off"},{prefix:n(()=>[l(s,{class:"input-icon"},{default:n(()=>[l(b(C))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"password"},{default:n(()=>[l(i,{modelValue:d.password,"onUpdate:modelValue":e[1]||(e[1]=o=>d.password=o),type:"password",placeholder:"请输入密码",size:"large","show-password":"",clearable:"",autocomplete:"new-password"},{prefix:n(()=>[l(s,{class:"input-icon"},{default:n(()=>[l(b(E))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,null,{default:n(()=>[l(h,{type:"primary",size:"large",class:"login-button",loading:_.value,onClick:X},{default:n(()=>[G(x(_.value?"登录中...":"登 录"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])])}}},_e=z(pe,[["__scopeId","data-v-965ad2f4"]]);export{_e as default};
