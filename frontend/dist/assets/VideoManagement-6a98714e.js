import{_ as W,u as X,r as d,b as Y,Z as ee,c as r,a0 as le,o as S,d as ae,e as b,g as l,w as n,E as c,h as te,i as z,M as oe,q as i,D as ne,ac as de,y as re,k as se,ad as ie}from"./index-80cba2ab.js";import{g as ue,a as pe,u as me,d as ce}from"./video-873b7efb.js";import{G as q}from"./GroupSelector-8b0f2cde.js";import"./group-46b94c56.js";const ge={class:"video-management-page"},ve={class:"panel-header"},fe={class:"pagination-container"},_e={__name:"VideoManagement",setup(Ve){const G=X(),D=d([]),y=d(!1),g=d(1),V=d(20),U=d(0),I=d(""),h=d(null),u=d(!1),k=d("æ·»åŠ è§†é¢‘è®¾å¤‡"),v=d("add"),w=d(!1),x=d(null),a=Y({id:null,name:"",deviceId:"",channelId:"",groupId:null,remark:""}),E={name:[{required:!0,message:"è¯·è¾“å…¥è®¾å¤‡åç§°",trigger:"blur"},{min:1,max:50,message:"é•¿åº¦åœ¨1åˆ°50ä¸ªå­—ç¬¦",trigger:"blur"}],deviceId:[{required:!0,message:"è¯·è¾“å…¥è®¾å¤‡ç¼–ç ",trigger:"blur"},{pattern:/^\d+$/,message:"è®¾å¤‡ç¼–ç å¿…é¡»ä¸ºæ•°å­—",trigger:"blur"}],channelId:[{required:!0,message:"è¯·è¾“å…¥é€šé“ç¼–ç ",trigger:"blur"},{pattern:/^\d+$/,message:"é€šé“ç¼–ç å¿…é¡»ä¸ºæ•°å­—",trigger:"blur"}],groupId:[{required:!0,message:"è¯·é€‰æ‹©æ‰€å±žåˆ†ç»„",trigger:"change"}]},L=t=>(g.value-1)*V.value+t+1,p=async()=>{y.value=!0;try{const t={page:g.value,pageSize:V.value,search:I.value||void 0,groupId:h.value||void 0},e=await ue(t);D.value=e.list||[],U.value=e.total||0}catch(t){c.error("æŸ¥è¯¢å¤±è´¥: "+t.message)}finally{y.value=!1}},B=()=>{g.value=1,p()},N=()=>{p()},M=()=>{p()},R=t=>{G.push(`/video/detail/${t.deviceId}/${t.channelId}`)},T=()=>{v.value="add",k.value="æ·»åŠ è§†é¢‘è®¾å¤‡",A(),u.value=!0},P=t=>{v.value="edit",k.value="ç¼–è¾‘è§†é¢‘è®¾å¤‡",a.id=t.id,a.name=t.name,a.deviceId=t.deviceId,a.channelId=t.channelId,a.groupId=t.groupId,a.remark=t.remark||"",u.value=!0},K=async()=>{await x.value.validate(),w.value=!0;try{v.value==="add"?(await pe(a),c.success("æ·»åŠ æˆåŠŸ")):(await me(a),c.success("ä¿®æ”¹æˆåŠŸ")),u.value=!1,p()}catch(t){c.error("ä¿å­˜å¤±è´¥: "+t.message)}finally{w.value=!1}},j=async t=>{await ie.confirm(`ç¡®å®šåˆ é™¤è§†é¢‘è®¾å¤‡"${t.name}"å—ï¼Ÿ`,"åˆ é™¤ç¡®è®¤",{type:"warning",confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ"});try{await ce(t.id),c.success("åˆ é™¤æˆåŠŸ"),p()}catch(e){c.error("åˆ é™¤å¤±è´¥: "+e.message)}},A=()=>{var t;a.id=null,a.name="",a.deviceId="",a.channelId="",a.groupId=null,a.remark="",(t=x.value)==null||t.clearValidate()};return ee(()=>{p()}),(t,e)=>{const f=r("el-input"),C=r("el-icon"),s=r("el-button"),m=r("el-table-column"),F=r("el-table"),Q=r("el-pagination"),Z=r("el-card"),_=r("el-form-item"),H=r("el-form"),J=r("el-dialog"),O=le("loading");return S(),ae("div",ge,[e[20]||(e[20]=b("h1",{class:"page-title"},"è§†é¢‘ç®¡ç†",-1)),l(Z,{class:"video-panel",shadow:"hover"},{header:n(()=>[b("div",ve,[e[14]||(e[14]=b("h3",{class:"panel-title"},"å…¨éƒ¨è§†é¢‘è®¾å¤‡",-1)),l(f,{modelValue:I.value,"onUpdate:modelValue":e[0]||(e[0]=o=>I.value=o),placeholder:"ðŸ” æœç´¢è§†é¢‘åç§°æˆ–ç¼–ç ",clearable:"",class:"search-input",onKeyup:te(B,["enter"])},null,8,["modelValue"]),l(q,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=o=>h.value=o),placeholder:"æ‰€å±žåˆ†ç»„",clearable:"",class:"filter-select"},null,8,["modelValue"]),l(s,{type:"primary",onClick:B},{default:n(()=>[l(C,null,{default:n(()=>[l(z(oe))]),_:1}),e[11]||(e[11]=i("æŸ¥è¯¢ ",-1))]),_:1}),l(s,{onClick:N},{default:n(()=>[l(C,null,{default:n(()=>[l(z(ne))]),_:1}),e[12]||(e[12]=i("åˆ·æ–° ",-1))]),_:1}),l(s,{type:"primary",onClick:T},{default:n(()=>[l(C,null,{default:n(()=>[l(z(de))]),_:1}),e[13]||(e[13]=i("æ·»åŠ è§†é¢‘è®¾å¤‡ ",-1))]),_:1})])]),default:n(()=>[re((S(),se(F,{data:D.value,stripe:"",style:{width:"100%"}},{default:n(()=>[l(m,{type:"index",label:"åºå·",width:"80",index:L}),l(m,{prop:"name",label:"è§†é¢‘åç§°","min-width":"150","show-overflow-tooltip":""}),l(m,{prop:"deviceId",label:"è§†é¢‘ç¼–ç ","min-width":"200","show-overflow-tooltip":""}),l(m,{prop:"channelId",label:"é€šé“ç¼–ç ","min-width":"200","show-overflow-tooltip":""}),l(m,{prop:"groupName",label:"æ‰€å±žåˆ†ç»„","min-width":"120"}),l(m,{label:"æ“ä½œ",width:"240",fixed:"right"},{default:n(({row:o})=>[l(s,{size:"small",type:"primary",link:"",onClick:$=>R(o)},{default:n(()=>[...e[15]||(e[15]=[i(" è¯¦æƒ… ",-1)])]),_:1},8,["onClick"]),l(s,{size:"small",type:"primary",link:"",onClick:$=>P(o)},{default:n(()=>[...e[16]||(e[16]=[i(" ç¼–è¾‘ ",-1)])]),_:1},8,["onClick"]),l(s,{size:"small",type:"danger",link:"",onClick:$=>j(o)},{default:n(()=>[...e[17]||(e[17]=[i(" åˆ é™¤ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,y.value]]),b("div",fe,[l(Q,{"current-page":g.value,"onUpdate:currentPage":e[2]||(e[2]=o=>g.value=o),"page-size":V.value,"onUpdate:pageSize":e[3]||(e[3]=o=>V.value=o),"page-sizes":[10,20,50,100],total:U.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:M,onCurrentChange:M},null,8,["current-page","page-size","total"])])]),_:1}),l(J,{modelValue:u.value,"onUpdate:modelValue":e[10]||(e[10]=o=>u.value=o),title:k.value,width:"600px","close-on-click-modal":!1},{footer:n(()=>[l(s,{onClick:e[9]||(e[9]=o=>u.value=!1)},{default:n(()=>[...e[18]||(e[18]=[i("å–æ¶ˆ",-1)])]),_:1}),l(s,{type:"primary",onClick:K,loading:w.value},{default:n(()=>[...e[19]||(e[19]=[i("ç¡®å®š",-1)])]),_:1},8,["loading"])]),default:n(()=>[l(H,{ref_key:"formRef",ref:x,model:a,rules:E,"label-width":"100px"},{default:n(()=>[l(_,{label:"è§†é¢‘åç§°",prop:"name"},{default:n(()=>[l(f,{modelValue:a.name,"onUpdate:modelValue":e[4]||(e[4]=o=>a.name=o),placeholder:"è¯·è¾“å…¥è§†é¢‘è®¾å¤‡åç§°",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(_,{label:"è§†é¢‘ç¼–ç ",prop:"deviceId"},{default:n(()=>[l(f,{modelValue:a.deviceId,"onUpdate:modelValue":e[5]||(e[5]=o=>a.deviceId=o),placeholder:"è¯·è¾“å…¥GB28181è®¾å¤‡ç¼–ç ï¼ˆæ•°å­—ï¼‰",maxlength:"50",disabled:v.value==="edit"},null,8,["modelValue","disabled"])]),_:1}),l(_,{label:"é€šé“ç¼–ç ",prop:"channelId"},{default:n(()=>[l(f,{modelValue:a.channelId,"onUpdate:modelValue":e[6]||(e[6]=o=>a.channelId=o),placeholder:"è¯·è¾“å…¥GB28181é€šé“ç¼–ç ï¼ˆæ•°å­—ï¼‰",maxlength:"50",disabled:v.value==="edit"},null,8,["modelValue","disabled"])]),_:1}),l(_,{label:"æ‰€å±žåˆ†ç»„",prop:"groupId"},{default:n(()=>[l(q,{modelValue:a.groupId,"onUpdate:modelValue":e[7]||(e[7]=o=>a.groupId=o),placeholder:"è¯·é€‰æ‹©åˆ†ç»„",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(_,{label:"å¤‡æ³¨è¯´æ˜Ž",prop:"remark"},{default:n(()=>[l(f,{modelValue:a.remark,"onUpdate:modelValue":e[8]||(e[8]=o=>a.remark=o),type:"textarea",rows:3,placeholder:"è¯·è¾“å…¥å¤‡æ³¨è¯´æ˜Ž",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ke=W(_e,[["__scopeId","data-v-b457ac3f"]]);export{ke as default};
