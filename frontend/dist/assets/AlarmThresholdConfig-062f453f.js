import{_ as ye,r as N,b as S,Z as he,c as A,a0 as Ve,o as r,d as h,e as l,q as g,t as y,g as t,w as i,h as _e,i as R,y as we,k as v,E as k,M as ae,F as B,f as $,ac as ke,B as F,a1 as se,ad as te}from"./index-80cba2ab.js";import{g as oe}from"./device-4324fee6.js";import{g as Ce,a as Ue}from"./product-a74919bb.js";import{g as Ae}from"./user-9d12fbba.js";import{c as G}from"./alarm-fa8ea6fa.js";import{G as ne}from"./GroupSelector-8b0f2cde.js";import"./group-46b94c56.js";const Ee={class:"alarm-config-page"},Ie={class:"page-header"},xe={class:"stats-quick"},Me={class:"stat-item"},Oe={class:"stat-item active"},ze={class:"stat-item inactive"},Ne={class:"filter-bar"},je={class:"table-container"},De={class:"device-name-cell"},Se={class:"device-name-text"},Be={class:"device-code-text"},$e={key:0,class:"tag configured"},qe={key:1,class:"tag unconfigured"},Pe={key:0,class:"handler-user-text"},Le={key:1,class:"empty-text"},Te={class:"pagination-wrapper"},Fe={class:"dialog-body"},Ge={class:"info-section"},Je={class:"info-grid"},Ke={class:"info-item"},Ze={class:"info-value"},He={class:"info-item"},Qe={class:"info-value code"},Re={class:"info-item"},We={class:"info-value"},Xe={class:"info-item"},Ye={class:"info-value"},el={class:"form-section"},ll={class:"form-field"},al={class:"form-field"},sl={class:"switch-field"},tl={class:"form-field"},ol={class:"switch-field"},nl={class:"form-field"},il={class:"switch-field"},dl={class:"form-section"},rl={key:0,style:{"font-weight":"600",color:"#1d1d1f"}},fl={key:1},ml={key:0,class:"field-unit"},ul={key:1,class:"field-unit"},cl={class:"dialog-footer"},pl={class:"dialog-body"},bl={class:"form-section"},gl={class:"form-field"},vl={class:"form-field"},yl={class:"form-field"},hl={class:"device-select-area"},Vl={class:"select-header"},_l={class:"select-info"},wl={key:0,class:"warn-text"},kl={class:"device-list"},Cl={class:"device-details"},Ul={class:"device-title-row"},Al={class:"device-title-text"},El={class:"device-meta-text"},Il={class:"form-section"},xl={class:"form-field"},Ml={class:"form-field"},Ol={class:"switch-field"},zl={class:"form-field"},Nl={class:"switch-field"},jl={class:"form-field"},Dl={class:"switch-field"},Sl={class:"form-field"},Bl={key:0,style:{"font-weight":"600",color:"#1d1d1f"}},$l={key:1},ql={key:0,class:"field-unit"},Pl={key:1,class:"field-unit"},Ll={class:"dialog-footer"},Tl={__name:"AlarmThresholdConfig",setup(Fl){const J=N(!1),q=N([]),K=N([]),P=N([]),Z=N([]),L=N([]),H=N({}),I=S({total:0,configured:0,unconfigured:0}),V=S({keyword:"",productId:null,groupId:null,configStatus:null,onlineStatus:null}),O=S({page:1,pageSize:20,total:0}),n=S({visible:!1,device:null,form:{level:"warning",conditions:[{metric:"",operator:">",threshold:0}],notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}}),s=S({visible:!1,productId:null,groupId:null,availableDevices:[],selectedDeviceIds:[],selectAll:!1,configuredCount:0,form:{level:"warning",conditions:[{metric:"",operator:">",threshold:0}],notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}}),z=async()=>{var o,e;J.value=!0;try{const f={page:O.page,pageSize:O.pageSize,keyword:V.keyword||void 0,productId:V.productId||void 0,groupId:V.groupId||void 0,status:V.onlineStatus!==null?V.onlineStatus:void 0},p=await oe(f);if(p&&p.list){let d=p.list||[];d=d.map(u=>{if(u.alarmConfig)try{u.alarmConfigObj=JSON.parse(u.alarmConfig)}catch{u.alarmConfigObj=null}return u}),V.configStatus&&(d=d.filter(u=>V.configStatus==="configured"?u.alarmConfig:V.configStatus==="unconfigured"?!u.alarmConfig:!0)),q.value=d,O.total=p.total||0,I.total=p.total||0,I.configured=d.filter(u=>u.alarmConfig).length,I.unconfigured=d.filter(u=>!u.alarmConfig).length}else q.value=[],O.total=0,I.total=0,I.configured=0,I.unconfigured=0}catch(f){console.error("åŠ è½½è®¾å¤‡åˆ—è¡¨å¤±è´¥:",f);const p=((e=(o=f==null?void 0:f.response)==null?void 0:o.data)==null?void 0:e.message)||(f==null?void 0:f.message)||"åŠ è½½è®¾å¤‡åˆ—è¡¨å¤±è´¥";k.error(p),q.value=[],O.total=0,I.total=0,I.configured=0,I.unconfigured=0}finally{J.value=!1}},ie=async()=>{try{const o=await Ce({});o&&(K.value=o.list||(Array.isArray(o)?o:[]))}catch(o){console.error("åŠ è½½äº§å“åˆ—è¡¨å¤±è´¥:",o)}},de=async()=>{try{const o=await Ae({page:1,pageSize:1e3});o&&o.list&&(P.value=o.list||[])}catch(o){console.error("åŠ è½½ç”¨æˆ·åˆ—è¡¨å¤±è´¥:",o)}},W=async o=>{if(!o)return[];if(H.value[o])return H.value[o];try{const e=await Ue(o);if(e){const f=Array.isArray(e)?e:[];return H.value[o]=f,f}return[]}catch(e){return console.error("åŠ è½½ç‰©æ¨¡å‹å±æ€§å¤±è´¥:",e),[]}},re=async o=>{n.device=o,n.visible=!0;const e=await W(o.productId);Z.value=[{addr:"__offline__",attrName:"ç¦»çº¿æŠ¥è­¦"},...e];const f={};e.forEach(p=>{f[p.addr]={enabled:!1,operator:">",threshold:0,level:"warning"}}),o.alarmConfigObj&&o.alarmConfigObj.metrics?(Object.keys(o.alarmConfigObj.metrics).forEach(p=>{f[p]&&(f[p]={...o.alarmConfigObj.metrics[p]})}),n.form={notifyUser:o.alarmConfigObj.notifyUser||null,stackMode:o.alarmConfigObj.stackMode!==!1,mailEnabled:o.alarmConfigObj.mailEnabled||!1,smsEnabled:o.alarmConfigObj.smsEnabled||!1,metrics:f,offlineAlarm:o.alarmConfigObj.offlineAlarm||{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}):o.alarmConfigObj&&o.alarmConfigObj.conditions?(o.alarmConfigObj.conditions.forEach(p=>{f[p.metric]&&(f[p.metric]={enabled:!0,operator:p.operator,threshold:p.threshold,level:o.alarmConfigObj.level||"warning"})}),n.form={notifyUser:o.alarmConfigObj.notifyUsers&&o.alarmConfigObj.notifyUsers.length>0?o.alarmConfigObj.notifyUsers[0]:null,stackMode:o.alarmConfigObj.stackMode!==!1,mailEnabled:o.alarmConfigObj.mailEnabled||!1,smsEnabled:o.alarmConfigObj.smsEnabled||!1,metrics:f,offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}):n.form={notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,metrics:f,offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}},fe=async()=>{var f,p,d,u,U;const o=Object.entries(n.form.metrics).filter(([m,E])=>E.enabled),e=(f=n.form.offlineAlarm)==null?void 0:f.enabled;if(o.length===0&&!e)try{await G({deviceId:n.device.id,alarmConfig:{notifyUser:n.form.notifyUser||null,stackMode:n.form.stackMode,metrics:n.form.metrics,offlineAlarm:n.form.offlineAlarm},enabled:!1}),k.success("å·²æ›´æ–°è®¾å¤‡æŠ¥è­¦é…ç½®"),n.visible=!1,z();return}catch(m){console.error("é…ç½®å¤±è´¥:",m),k.error("é…ç½®å¤±è´¥ï¼š"+(((d=(p=m.response)==null?void 0:p.data)==null?void 0:d.message)||m.message));return}if((o.length>0||e)&&!n.form.notifyUser){k.warning("å¯ç”¨ç›‘æ§æ—¶å¿…é¡»é€‰æ‹©å¤„ç†äºº");return}for(const[m,E]of o){if(!E.operator||E.threshold===null||E.threshold===void 0){k.warning(`ç›‘æ§å±æ€§ "${X(m)}" çš„é…ç½®ä¸å®Œæ•´ï¼Œè¯·æ£€æŸ¥è¿ç®—ç¬¦å’Œé˜ˆå€¼`);return}if(!E.level){k.warning(`ç›‘æ§å±æ€§ "${X(m)}" æœªè®¾ç½®æŠ¥è­¦çº§åˆ«`);return}}try{await G({deviceId:n.device.id,alarmConfig:{notifyUser:n.form.notifyUser,stackMode:n.form.stackMode,mailEnabled:n.form.mailEnabled,smsEnabled:n.form.smsEnabled,metrics:n.form.metrics,offlineAlarm:n.form.offlineAlarm},enabled:!0}),k.success("é…ç½®æˆåŠŸ"),n.visible=!1,z()}catch(m){console.error("é…ç½®å¤±è´¥:",m),k.error("é…ç½®å¤±è´¥ï¼š"+(((U=(u=m.response)==null?void 0:u.data)==null?void 0:U.message)||m.message))}},X=o=>{const e=Z.value.find(f=>f.addr===o);return e?e.attrName:o},me=()=>{s.visible=!0,s.productId=null,s.groupId=null,s.availableDevices=[],s.selectedDeviceIds=[],s.selectAll=!1,s.configuredCount=0,s.form={notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,metrics:{},offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}},ue=async()=>{if(s.productId){const o=await W(s.productId);L.value=[{addr:"__offline__",attrName:"ç¦»çº¿æŠ¥è­¦"},...o];const e={};o.forEach(f=>{e[f.addr]={enabled:!1,operator:">",threshold:0,level:"warning"}}),s.form.metrics=e,await Y()}},Y=async()=>{if(s.productId)try{const o={page:1,pageSize:1e4,productId:s.productId,groupId:s.groupId||void 0},e=await oe(o);e&&e.list&&(s.availableDevices=(e.list||[]).map(f=>{if(f.alarmConfig)try{f.alarmConfigObj=JSON.parse(f.alarmConfig)}catch{}return{...f,selected:!1}}),Q())}catch(o){console.error("åŠ è½½è®¾å¤‡å¤±è´¥:",o)}},ce=()=>{s.availableDevices.forEach(o=>{o.selected=s.selectAll}),Q()},Q=()=>{s.selectedDeviceIds=s.availableDevices.filter(o=>o.selected).map(o=>o.id),s.configuredCount=s.availableDevices.filter(o=>o.selected&&o.alarmConfig).length,s.selectAll=s.selectedDeviceIds.length===s.availableDevices.length&&s.availableDevices.length>0},pe=async()=>{var f,p,d,u,U,m,E,T;if(s.selectedDeviceIds.length===0){k.warning("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªè®¾å¤‡");return}const o=Object.entries(s.form.metrics).filter(([b,x])=>x.enabled);if(o.length===0&&!((f=s.form.offlineAlarm)!=null&&f.enabled))try{await te.confirm(`ç¡®è®¤æ›´æ–° ${s.selectedDeviceIds.length} å°è®¾å¤‡çš„æŠ¥è­¦é…ç½®ï¼Ÿ

æ³¨æ„ï¼šå°†å…³é—­æ‰€æœ‰æŠ¥è­¦ç›‘æ§ï¼`,"ç¡®è®¤æ›´æ–°è®¾å¤‡æŠ¥è­¦é…ç½®",{type:"warning"}),await G({deviceIds:s.selectedDeviceIds,alarmConfig:{notifyUser:s.form.notifyUser||null,stackMode:s.form.stackMode,metrics:s.form.metrics,offlineAlarm:s.form.offlineAlarm},enabled:!1}),k.success(`å·²æ›´æ–° ${s.selectedDeviceIds.length} å°è®¾å¤‡çš„æŠ¥è­¦é…ç½®`),s.visible=!1,z();return}catch(b){b!=="cancel"&&(console.error("é…ç½®å¤±è´¥:",b),k.error("é…ç½®å¤±è´¥ï¼š"+(((d=(p=b.response)==null?void 0:p.data)==null?void 0:d.message)||b.message)));return}const e=(u=s.form.offlineAlarm)==null?void 0:u.enabled;if((o.length>0||e)&&!s.form.notifyUser){k.warning("å¯ç”¨ç›‘æ§æ—¶å¿…é¡»é€‰æ‹©å¤„ç†äºº");return}for(const[b,x]of o){if(!x.operator||x.threshold===null||x.threshold===void 0){const j=((U=L.value.find(D=>D.addr===b))==null?void 0:U.attrName)||b;k.warning(`ç›‘æ§å±æ€§ "${j}" çš„é…ç½®ä¸å®Œæ•´ï¼Œè¯·æ£€æŸ¥è¿ç®—ç¬¦å’Œé˜ˆå€¼`);return}if(!x.level){const j=((m=L.value.find(D=>D.addr===b))==null?void 0:m.attrName)||b;k.warning(`ç›‘æ§å±æ€§ "${j}" æœªè®¾ç½®æŠ¥è­¦çº§åˆ«`);return}}try{await te.confirm(`ç¡®è®¤æ›´æ–° ${s.selectedDeviceIds.length} å°è®¾å¤‡çš„æŠ¥è­¦é…ç½®ï¼Ÿ

æ³¨æ„ï¼šå·²é…ç½®è®¾å¤‡çš„åŸæœ‰é˜ˆå€¼å°†è¢«è¦†ç›–ï¼`,"ç¡®è®¤æ›´æ–°è®¾å¤‡æŠ¥è­¦é…ç½®",{type:"warning"}),await G({deviceIds:s.selectedDeviceIds,alarmConfig:{notifyUser:s.form.notifyUser,stackMode:s.form.stackMode,mailEnabled:s.form.mailEnabled,smsEnabled:s.form.smsEnabled,metrics:s.form.metrics,offlineAlarm:s.form.offlineAlarm},enabled:!0}),k.success("æ‰¹é‡é…ç½®æˆåŠŸ"),s.visible=!1,z()}catch(b){b!=="cancel"&&(console.error("æ‰¹é‡é…ç½®å¤±è´¥:",b),k.error("é…ç½®å¤±è´¥ï¼š"+(((T=(E=b.response)==null?void 0:E.data)==null?void 0:T.message)||b.message)))}},be=o=>{const e=P.value.find(f=>f.id===o);return e?e.realName||e.username:"-"};return he(()=>{z(),ie(),de()}),(o,e)=>{const f=A("el-icon"),p=A("el-input"),d=A("el-option"),u=A("el-select"),U=A("el-button"),m=A("el-table-column"),E=A("el-table"),T=A("el-pagination"),b=A("el-switch"),x=A("el-input-number"),j=A("el-dialog"),D=A("el-alert"),ee=A("el-checkbox"),ge=A("el-tag"),ve=Ve("loading");return r(),h("div",Ee,[l("div",Ie,[e[33]||(e[33]=l("h2",{class:"page-title"},"âš™ï¸ è®¾å¤‡æŠ¥è­¦é˜ˆå€¼é…ç½®",-1)),l("div",xe,[l("span",Me,[e[30]||(e[30]=g("æ€»è®¾å¤‡ ",-1)),l("strong",null,y(I.total),1)]),l("span",Oe,[e[31]||(e[31]=g("å·²é…ç½® ",-1)),l("strong",null,y(I.configured),1)]),l("span",ze,[e[32]||(e[32]=g("æœªé…ç½® ",-1)),l("strong",null,y(I.unconfigured),1)])])]),l("div",Ne,[t(p,{modelValue:V.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>V.keyword=a),placeholder:"æœç´¢è®¾å¤‡åç§°/è®¾å¤‡ç¼–ç ",class:"search-input",clearable:"",onKeyup:_e(z,["enter"])},{prefix:i(()=>[t(f,null,{default:i(()=>[t(R(ae))]),_:1})]),_:1},8,["modelValue"]),t(u,{modelValue:V.productId,"onUpdate:modelValue":e[1]||(e[1]=a=>V.productId=a),placeholder:"äº§å“å‹å·",clearable:"",class:"filter-select",style:{width:"180px"}},{default:i(()=>[(r(!0),h(B,null,$(K.value,a=>(r(),v(d,{key:a.id,label:a.productName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(ne,{modelValue:V.groupId,"onUpdate:modelValue":e[2]||(e[2]=a=>V.groupId=a),placeholder:"è®¾å¤‡åˆ†ç»„",clearable:"",class:"filter-select",style:{width:"180px"}},null,8,["modelValue"]),t(u,{modelValue:V.configStatus,"onUpdate:modelValue":e[3]||(e[3]=a=>V.configStatus=a),placeholder:"é…ç½®çŠ¶æ€",clearable:"",class:"filter-select",style:{width:"140px"}},{default:i(()=>[t(d,{label:"å·²é…ç½®",value:"configured"}),t(d,{label:"æœªé…ç½®",value:"unconfigured"})]),_:1},8,["modelValue"]),t(u,{modelValue:V.onlineStatus,"onUpdate:modelValue":e[4]||(e[4]=a=>V.onlineStatus=a),placeholder:"åœ¨çº¿çŠ¶æ€",clearable:"",class:"filter-select",style:{width:"140px"}},{default:i(()=>[t(d,{label:"åœ¨çº¿",value:1}),t(d,{label:"ç¦»çº¿",value:0})]),_:1},8,["modelValue"]),t(U,{type:"primary",onClick:z,icon:R(ae),style:{"margin-left":"8px"}},{default:i(()=>[...e[34]||(e[34]=[g("æŸ¥è¯¢",-1)])]),_:1},8,["icon"]),t(U,{type:"primary",onClick:me,icon:R(ke)},{default:i(()=>[...e[35]||(e[35]=[g("æ‰¹é‡é…ç½®",-1)])]),_:1},8,["icon"])]),l("div",je,[we((r(),v(E,{data:q.value,stripe:"",style:{width:"100%"}},{default:i(()=>[t(m,{prop:"deviceName",label:"è®¾å¤‡åç§°","min-width":"130","show-overflow-tooltip":""},{default:i(({row:a})=>[l("div",De,[l("span",{class:F(["status-dot",a.status===1?"online":"offline"])},null,2),l("span",Se,y(a.deviceName),1)])]),_:1}),t(m,{prop:"deviceCode",label:"è®¾å¤‡ç¼–ç ","min-width":"130","show-overflow-tooltip":""},{default:i(({row:a})=>[l("span",Be,y(a.deviceCode),1)]),_:1}),t(m,{label:"åœ¨çº¿çŠ¶æ€",width:"90",align:"center"},{default:i(({row:a})=>[l("span",{class:F(["status-text",a.status===1?"status-online":"status-offline"])},y(a.status===1?"åœ¨çº¿":"ç¦»çº¿"),3)]),_:1}),t(m,{prop:"productName",label:"äº§å“åç§°","min-width":"140","show-overflow-tooltip":""}),t(m,{prop:"groupName",label:"æ‰€å±åˆ†ç»„","min-width":"110","show-overflow-tooltip":""}),t(m,{label:"é…ç½®çŠ¶æ€",width:"100",align:"center"},{default:i(({row:a})=>[a.alarmConfig?(r(),h("span",$e,"âœ“ å·²é…ç½®")):(r(),h("span",qe,"âœ— æœªé…ç½®"))]),_:1}),t(m,{label:"å¤„ç†äºº",width:"100","show-overflow-tooltip":""},{default:i(({row:a})=>[a.alarmConfigObj&&a.alarmConfigObj.notifyUser?(r(),h("span",Pe,y(be(a.alarmConfigObj.notifyUser)),1)):(r(),h("span",Le,"-"))]),_:1}),t(m,{label:"æ“ä½œ",width:"90",fixed:"right"},{default:i(({row:a})=>[t(U,{type:"primary",link:"",onClick:w=>re(a)},{default:i(()=>[...e[36]||(e[36]=[g("é…ç½®",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ve,J.value]])]),l("div",Te,[t(T,{"current-page":O.page,"onUpdate:currentPage":e[5]||(e[5]=a=>O.page=a),"page-size":O.pageSize,"onUpdate:pageSize":e[6]||(e[6]=a=>O.pageSize=a),total:O.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:z,onCurrentChange:z},null,8,["current-page","page-size","total"])]),t(j,{modelValue:n.visible,"onUpdate:modelValue":e[16]||(e[16]=a=>n.visible=a),title:"é˜ˆå€¼é…ç½®",width:"900px","close-on-click-modal":!1,top:"3vh",class:"config-dialog"},{footer:i(()=>[l("div",cl,[t(U,{onClick:e[15]||(e[15]=a=>n.visible=!1)},{default:i(()=>[...e[51]||(e[51]=[g("å–æ¶ˆ",-1)])]),_:1}),t(U,{type:"primary",onClick:fe},{default:i(()=>[...e[52]||(e[52]=[g("ä¿å­˜",-1)])]),_:1})])]),default:i(()=>{var a,w,_,le;return[l("div",Fe,[l("div",Ge,[e[41]||(e[41]=l("h3",{class:"section-title"},"è®¾å¤‡ä¿¡æ¯",-1)),l("div",Je,[l("div",Ke,[e[37]||(e[37]=l("span",{class:"info-label"},"è®¾å¤‡åç§°",-1)),l("span",Ze,y((a=n.device)==null?void 0:a.deviceName),1)]),l("div",He,[e[38]||(e[38]=l("span",{class:"info-label"},"è®¾å¤‡ç¼–ç ",-1)),l("code",Qe,y((w=n.device)==null?void 0:w.deviceCode),1)]),l("div",Re,[e[39]||(e[39]=l("span",{class:"info-label"},"äº§å“å‹å·",-1)),l("span",We,y((_=n.device)==null?void 0:_.productName),1)]),l("div",Xe,[e[40]||(e[40]=l("span",{class:"info-label"},"æ‰€å±åˆ†ç»„",-1)),l("span",Ye,y((le=n.device)==null?void 0:le.groupName),1)])])]),l("div",el,[e[49]||(e[49]=l("h3",{class:"section-title"},"å…¨å±€é…ç½®",-1)),l("div",ll,[e[42]||(e[42]=l("label",{class:"field-label"},[g(" å¤„ç†äºº "),l("span",{class:"required"},"*")],-1)),t(u,{modelValue:n.form.notifyUser,"onUpdate:modelValue":e[7]||(e[7]=c=>n.form.notifyUser=c),placeholder:"è¯·é€‰æ‹©å¤„ç†äºº",class:"field-select-full"},{default:i(()=>[(r(!0),h(B,null,$(P.value,c=>(r(),v(d,{key:c.id,label:c.realName||c.username,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",al,[e[44]||(e[44]=l("label",{class:"field-label"},"æŠ¥è­¦å †å ",-1)),l("div",sl,[t(b,{modelValue:n.form.stackMode,"onUpdate:modelValue":e[8]||(e[8]=c=>n.form.stackMode=c)},null,8,["modelValue"]),e[43]||(e[43]=l("span",{class:"switch-label"},"å¼€å¯åï¼Œæ¢å¤å‰ä¸ä¼šé‡å¤æŠ¥è­¦",-1))])]),l("div",tl,[e[46]||(e[46]=l("label",{class:"field-label"},"é‚®ä»¶é€šçŸ¥",-1)),l("div",ol,[t(b,{modelValue:n.form.mailEnabled,"onUpdate:modelValue":e[9]||(e[9]=c=>n.form.mailEnabled=c)},null,8,["modelValue"]),e[45]||(e[45]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€é‚®ä»¶é€šçŸ¥å¤„ç†äºº",-1))])]),l("div",nl,[e[48]||(e[48]=l("label",{class:"field-label"},"çŸ­ä¿¡é€šçŸ¥",-1)),l("div",il,[t(b,{modelValue:n.form.smsEnabled,"onUpdate:modelValue":e[10]||(e[10]=c=>n.form.smsEnabled=c)},null,8,["modelValue"]),e[47]||(e[47]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€çŸ­ä¿¡é€šçŸ¥å¤„ç†äºº",-1))])])]),l("div",dl,[e[50]||(e[50]=l("h3",{class:"section-title"},"ç‰©æ¨¡å‹ç›‘æ§é…ç½®",-1)),t(E,{data:Z.value,border:"",style:{width:"100%"},"max-height":"300px"},{default:i(()=>[t(m,{label:"å±æ€§åç§°",width:"120"},{default:i(({row:c,$index:M})=>[M===0?(r(),h("span",rl,"ç¦»çº¿æŠ¥è­¦")):(r(),h("span",fl,y(c.attrName),1))]),_:1}),t(m,{label:"å¯ç”¨",width:"70",align:"center"},{default:i(({row:c,$index:M})=>[M===0?(r(),v(b,{key:0,modelValue:n.form.offlineAlarm.enabled,"onUpdate:modelValue":e[11]||(e[11]=C=>n.form.offlineAlarm.enabled=C),size:"small"},null,8,["modelValue"])):(r(),v(b,{key:1,modelValue:n.form.metrics[c.addr].enabled,"onUpdate:modelValue":C=>n.form.metrics[c.addr].enabled=C,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1}),t(m,{label:"è¿ç®—ç¬¦",width:"100"},{default:i(({row:c,$index:M})=>[M===0?(r(),v(u,{key:0,modelValue:n.form.offlineAlarm.operator,"onUpdate:modelValue":e[12]||(e[12]=C=>n.form.offlineAlarm.operator=C),disabled:!n.form.offlineAlarm.enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(d,{label:">",value:">"})]),_:1},8,["modelValue","disabled"])):(r(),v(u,{key:1,modelValue:n.form.metrics[c.addr].operator,"onUpdate:modelValue":C=>n.form.metrics[c.addr].operator=C,disabled:!n.form.metrics[c.addr].enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(d,{label:">",value:">"}),t(d,{label:"<",value:"<"}),t(d,{label:"=",value:"="})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1}),t(m,{label:"é˜ˆå€¼",width:"140"},{default:i(({row:c,$index:M})=>[M===0?(r(),v(x,{key:0,modelValue:n.form.offlineAlarm.threshold,"onUpdate:modelValue":e[13]||(e[13]=C=>n.form.offlineAlarm.threshold=C),disabled:!n.form.offlineAlarm.enabled,min:1,precision:0,step:1,size:"small",style:{width:"100%"}},null,8,["modelValue","disabled"])):(r(),v(x,{key:1,modelValue:n.form.metrics[c.addr].threshold,"onUpdate:modelValue":C=>n.form.metrics[c.addr].threshold=C,disabled:!n.form.metrics[c.addr].enabled,precision:2,step:.1,size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1}),t(m,{label:"å•ä½",width:"80",align:"center"},{default:i(({row:c,$index:M})=>[M===0?(r(),h("span",ml,"min")):(r(),h("span",ul,y(c.unit||"-"),1))]),_:1}),t(m,{label:"æŠ¥è­¦çº§åˆ«",width:"140"},{default:i(({row:c,$index:M})=>[M===0?(r(),v(u,{key:0,modelValue:n.form.offlineAlarm.level,"onUpdate:modelValue":e[14]||(e[14]=C=>n.form.offlineAlarm.level=C),disabled:!n.form.offlineAlarm.enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(d,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),t(d,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),t(d,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","disabled"])):(r(),v(u,{key:1,modelValue:n.form.metrics[c.addr].level,"onUpdate:modelValue":C=>n.form.metrics[c.addr].level=C,disabled:!n.form.metrics[c.addr].enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(d,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),t(d,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),t(d,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1})]),_:1},8,["data"])])])]}),_:1},8,["modelValue"]),t(j,{modelValue:s.visible,"onUpdate:modelValue":e[29]||(e[29]=a=>s.visible=a),title:"æ‰¹é‡é…ç½®",width:"1100px","close-on-click-modal":!1,top:"2vh",class:"batch-dialog"},{footer:i(()=>[l("div",Ll,[t(U,{onClick:e[28]||(e[28]=a=>s.visible=!1)},{default:i(()=>[...e[73]||(e[73]=[g("å–æ¶ˆ",-1)])]),_:1}),t(U,{type:"primary",onClick:pe},{default:i(()=>[...e[74]||(e[74]=[g("ç¡®è®¤é…ç½®",-1)])]),_:1})])]),default:i(()=>[l("div",pl,[t(D,{type:"warning",closable:!1,class:"warning-box"},{title:i(()=>[...e[53]||(e[53]=[l("strong",null,"é‡è¦æç¤º",-1),l("div",{class:"alert-desc"},[g(" æ‰¹é‡é…ç½®å°†"),l("strong",null,"è¦†ç›–"),g("å·²é€‰è®¾å¤‡çš„åŸæœ‰é…ç½®ï¼Œä»¥æœ¬æ¬¡è®¾ç½®ä¸ºå‡†ã€‚å·²é…ç½®è®¾å¤‡çš„æ—§é˜ˆå€¼å°†å¤±æ•ˆã€‚ ")],-1)])]),_:1}),l("div",bl,[l("div",gl,[e[54]||(e[54]=l("label",{class:"field-label"},[g(" é€‰æ‹©äº§å“ "),l("span",{class:"required"},"*")],-1)),t(u,{modelValue:s.productId,"onUpdate:modelValue":e[17]||(e[17]=a=>s.productId=a),placeholder:"è¯·å…ˆé€‰æ‹©äº§å“å‹å·",onChange:ue,class:"field-select-full"},{default:i(()=>[(r(!0),h(B,null,$(K.value,a=>(r(),v(d,{key:a.id,label:a.productName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[55]||(e[55]=l("div",{class:"field-hint"},"é€‰æ‹©äº§å“åï¼Œç›‘æ§é…ç½®å°†æ ¹æ®è¯¥äº§å“ç‰©æ¨¡å‹åŠ¨æ€åŠ è½½",-1))]),l("div",vl,[e[56]||(e[56]=l("label",{class:"field-label"},"è®¾å¤‡åˆ†ç»„",-1)),t(ne,{modelValue:s.groupId,"onUpdate:modelValue":e[18]||(e[18]=a=>s.groupId=a),placeholder:"å…¨éƒ¨åˆ†ç»„",clearable:"",onChange:Y,class:"field-select-full"},null,8,["modelValue"]),e[57]||(e[57]=l("div",{class:"field-hint"},"ç­›é€‰è¯¥äº§å“ä¸‹æŒ‡å®šåˆ†ç»„çš„è®¾å¤‡",-1))]),l("div",yl,[e[62]||(e[62]=l("label",{class:"field-label"},[g(" é€‰æ‹©è®¾å¤‡ "),l("span",{class:"required"},"*")],-1)),l("div",hl,[l("div",Vl,[t(ee,{modelValue:s.selectAll,"onUpdate:modelValue":e[19]||(e[19]=a=>s.selectAll=a),onChange:ce},{default:i(()=>[...e[58]||(e[58]=[g(" å…¨é€‰/å–æ¶ˆå…¨é€‰ ",-1)])]),_:1},8,["modelValue"]),l("span",_l,[e[59]||(e[59]=g(" å·²é€‰æ‹© ",-1)),l("strong",null,y(s.selectedDeviceIds.length),1),e[60]||(e[60]=g(" å°è®¾å¤‡ ",-1)),s.configuredCount>0?(r(),h("span",wl," ï¼ˆå…¶ä¸­ "+y(s.configuredCount)+" å°å·²é…ç½®ï¼‰ ",1)):se("",!0)])]),l("div",kl,[(r(!0),h(B,null,$(s.availableDevices,a=>(r(),h("div",{key:a.id,class:F(["device-item",{"is-selected":a.selected}])},[t(ee,{modelValue:a.selected,"onUpdate:modelValue":w=>a.selected=w,onChange:Q},null,8,["modelValue","onUpdate:modelValue"]),l("div",Cl,[l("div",Ul,[l("span",Al,y(a.deviceName),1),a.alarmConfig?(r(),v(ge,{key:0,type:"success",size:"small"},{default:i(()=>[...e[61]||(e[61]=[g("å·²é…ç½®",-1)])]),_:1})):se("",!0)]),l("div",El,[g(y(a.deviceCode)+" | "+y(a.groupName||"æœªåˆ†ç»„")+" | ",1),l("span",{class:F(a.status===1?"text-success":"text-gray")},y(a.status===1?"åœ¨çº¿":"ç¦»çº¿"),3)])])],2))),128))])])])]),e[72]||(e[72]=l("div",{class:"divider-line"},null,-1)),l("div",Il,[e[71]||(e[71]=l("h3",{class:"section-title"},"ç»Ÿä¸€é…ç½®",-1)),l("div",xl,[e[63]||(e[63]=l("label",{class:"field-label"},[g(" å¤„ç†äºº "),l("span",{class:"required"},"*")],-1)),t(u,{modelValue:s.form.notifyUser,"onUpdate:modelValue":e[20]||(e[20]=a=>s.form.notifyUser=a),placeholder:"è¯·é€‰æ‹©å¤„ç†äºº",class:"field-select-full"},{default:i(()=>[(r(!0),h(B,null,$(P.value,a=>(r(),v(d,{key:a.id,label:a.realName||a.username,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",Ml,[e[65]||(e[65]=l("label",{class:"field-label"},"æŠ¥è­¦å †å ",-1)),l("div",Ol,[t(b,{modelValue:s.form.stackMode,"onUpdate:modelValue":e[21]||(e[21]=a=>s.form.stackMode=a)},null,8,["modelValue"]),e[64]||(e[64]=l("span",{class:"switch-label"},"å¼€å¯åï¼Œæ¢å¤å‰ä¸ä¼šé‡å¤æŠ¥è­¦",-1))])]),l("div",zl,[e[67]||(e[67]=l("label",{class:"field-label"},"é‚®ä»¶é€šçŸ¥",-1)),l("div",Nl,[t(b,{modelValue:s.form.mailEnabled,"onUpdate:modelValue":e[22]||(e[22]=a=>s.form.mailEnabled=a)},null,8,["modelValue"]),e[66]||(e[66]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€é‚®ä»¶é€šçŸ¥å¤„ç†äºº",-1))])]),l("div",jl,[e[69]||(e[69]=l("label",{class:"field-label"},"çŸ­ä¿¡é€šçŸ¥",-1)),l("div",Dl,[t(b,{modelValue:s.form.smsEnabled,"onUpdate:modelValue":e[23]||(e[23]=a=>s.form.smsEnabled=a)},null,8,["modelValue"]),e[68]||(e[68]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€çŸ­ä¿¡é€šçŸ¥å¤„ç†äºº",-1))])]),l("div",Sl,[e[70]||(e[70]=l("label",{class:"field-label"},[g(" ç‰©æ¨¡å‹ç›‘æ§é…ç½® "),l("span",{class:"required"},"*")],-1)),t(E,{data:L.value,border:"",style:{width:"100%"},"max-height":"300px"},{default:i(()=>[t(m,{label:"å±æ€§åç§°",width:"120"},{default:i(({row:a,$index:w})=>[w===0?(r(),h("span",Bl,"ç¦»çº¿æŠ¥è­¦")):(r(),h("span",$l,y(a.attrName),1))]),_:1}),t(m,{label:"å¯ç”¨",width:"70",align:"center"},{default:i(({row:a,$index:w})=>[w===0?(r(),v(b,{key:0,modelValue:s.form.offlineAlarm.enabled,"onUpdate:modelValue":e[24]||(e[24]=_=>s.form.offlineAlarm.enabled=_),size:"small"},null,8,["modelValue"])):(r(),v(b,{key:1,modelValue:s.form.metrics[a.addr].enabled,"onUpdate:modelValue":_=>s.form.metrics[a.addr].enabled=_,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1}),t(m,{label:"è¿ç®—ç¬¦",width:"100"},{default:i(({row:a,$index:w})=>[w===0?(r(),v(u,{key:0,modelValue:s.form.offlineAlarm.operator,"onUpdate:modelValue":e[25]||(e[25]=_=>s.form.offlineAlarm.operator=_),disabled:!s.form.offlineAlarm.enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(d,{label:">",value:">"})]),_:1},8,["modelValue","disabled"])):(r(),v(u,{key:1,modelValue:s.form.metrics[a.addr].operator,"onUpdate:modelValue":_=>s.form.metrics[a.addr].operator=_,disabled:!s.form.metrics[a.addr].enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(d,{label:">",value:">"}),t(d,{label:"<",value:"<"}),t(d,{label:"=",value:"="})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1}),t(m,{label:"é˜ˆå€¼",width:"140"},{default:i(({row:a,$index:w})=>[w===0?(r(),v(x,{key:0,modelValue:s.form.offlineAlarm.threshold,"onUpdate:modelValue":e[26]||(e[26]=_=>s.form.offlineAlarm.threshold=_),disabled:!s.form.offlineAlarm.enabled,min:1,precision:0,step:1,size:"small",style:{width:"100%"}},null,8,["modelValue","disabled"])):(r(),v(x,{key:1,modelValue:s.form.metrics[a.addr].threshold,"onUpdate:modelValue":_=>s.form.metrics[a.addr].threshold=_,disabled:!s.form.metrics[a.addr].enabled,precision:2,step:.1,size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1}),t(m,{label:"å•ä½",width:"80",align:"center"},{default:i(({row:a,$index:w})=>[w===0?(r(),h("span",ql,"min")):(r(),h("span",Pl,y(a.unit||"-"),1))]),_:1}),t(m,{label:"æŠ¥è­¦çº§åˆ«",width:"140"},{default:i(({row:a,$index:w})=>[w===0?(r(),v(u,{key:0,modelValue:s.form.offlineAlarm.level,"onUpdate:modelValue":e[27]||(e[27]=_=>s.form.offlineAlarm.level=_),disabled:!s.form.offlineAlarm.enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(d,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),t(d,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),t(d,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","disabled"])):(r(),v(u,{key:1,modelValue:s.form.metrics[a.addr].level,"onUpdate:modelValue":_=>s.form.metrics[a.addr].level=_,disabled:!s.form.metrics[a.addr].enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(d,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),t(d,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),t(d,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1})]),_:1},8,["data"])])])])]),_:1},8,["modelValue"])])}}},Wl=ye(Tl,[["__scopeId","data-v-ac7980e5"]]);export{Wl as default};
