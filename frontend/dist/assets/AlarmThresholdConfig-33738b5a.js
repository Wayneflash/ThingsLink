import{_ as Ve,b as S,c as j,v as he,d as I,y as _e,o as r,e as h,f as l,q as v,t as V,g as t,w as i,h as we,i as R,B as ke,I as y,E as k,J as se,F as D,C as N,L as Ce,z as L,A as te,M as oe}from"./index-516a5ee0.js";import{g as W}from"./device-5313cd50.js";import{g as Ue,a as Ae}from"./product-9cf21d54.js";import{g as Ie}from"./user-6d072bad.js";import{c as T}from"./alarm-0adf561f.js";import{G as ne}from"./GroupSelector-59efcc02.js";import"./group-114b49f7.js";const Ee={class:"alarm-config-page"},xe={class:"page-header"},Me={class:"stats-quick"},ze={class:"stat-item"},Se={class:"stat-item active"},Oe={class:"stat-item inactive"},je={class:"filter-bar"},De={class:"table-container"},Ne={class:"device-name-cell"},Be={class:"device-name-text"},$e={class:"device-code-text"},qe={key:0,class:"tag configured"},Pe={key:1,class:"tag unconfigured"},Le={key:0,class:"handler-user-text"},Te={key:1,class:"empty-text"},Je={class:"pagination-wrapper"},Fe={class:"dialog-body"},Ge={class:"info-section"},Ke={class:"info-grid"},He={class:"info-item"},Qe={class:"info-value"},Re={class:"info-item"},We={class:"info-value code"},Xe={class:"info-item"},Ye={class:"info-value"},Ze={class:"info-item"},el={class:"info-value"},ll={class:"form-section"},al={class:"form-field"},sl={class:"form-field"},tl={class:"switch-field"},ol={class:"form-field"},nl={class:"switch-field"},il={class:"form-field"},dl={class:"switch-field"},rl={class:"form-section"},fl={key:0,style:{"font-weight":"600",color:"#1d1d1f"}},ml={key:1},ul={key:0,class:"field-unit"},cl={key:1,class:"field-unit"},pl={class:"dialog-footer"},bl={class:"dialog-body"},gl={class:"form-section"},vl={class:"form-field"},yl={class:"form-field"},Vl={class:"form-field"},hl={class:"device-select-area"},_l={class:"select-header"},wl={class:"select-info"},kl={key:0,class:"warn-text"},Cl={class:"device-list"},Ul={class:"device-details"},Al={class:"device-title-row"},Il={class:"device-title-text"},El={class:"device-meta-text"},xl={class:"form-section"},Ml={class:"form-field"},zl={class:"form-field"},Sl={class:"switch-field"},Ol={class:"form-field"},jl={class:"switch-field"},Dl={class:"form-field"},Nl={class:"switch-field"},Bl={class:"form-field"},$l={key:0,style:{"font-weight":"600",color:"#1d1d1f"}},ql={key:1},Pl={key:0,class:"field-unit"},Ll={key:1,class:"field-unit"},Tl={class:"dialog-footer"},Jl={__name:"AlarmThresholdConfig",setup(Fl){const J=S(!1),B=S([]),F=S([]),$=S([]),G=S([]),q=S([]),K=S({}),U=j({total:0,configured:0,unconfigured:0}),g=j({keyword:"",productId:null,groupId:null,configStatus:null,onlineStatus:null}),x=j({page:1,pageSize:20,total:0}),n=j({visible:!1,device:null,form:{level:"warning",conditions:[{metric:"",operator:">",threshold:0}],notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}}),s=j({visible:!1,productId:null,groupId:null,availableDevices:[],selectedDeviceIds:[],selectAll:!1,configuredCount:0,form:{level:"warning",conditions:[{metric:"",operator:">",threshold:0}],notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}}),z=async()=>{var o,e;J.value=!0;try{const d={page:x.page,pageSize:x.pageSize,keyword:g.keyword||void 0,productId:g.productId||void 0,groupId:g.groupId||void 0,status:g.onlineStatus!==null?g.onlineStatus:void 0},b=await W(d);if(b&&b.list){let f=b.list||[];f=f.map(p=>{if(p.alarmConfig)try{p.alarmConfigObj=JSON.parse(p.alarmConfig)}catch{p.alarmConfigObj=null}return p}),g.configStatus&&(f=f.filter(p=>g.configStatus==="configured"?p.alarmConfig:g.configStatus==="unconfigured"?!p.alarmConfig:!0)),B.value=f,x.total=b.total||0;const u=[...new Set(f.map(p=>p.productId).filter(Boolean))];await Promise.all(u.map(p=>H(p))),X()}else B.value=[],x.total=0,X()}catch(d){console.error("åŠ è½½è®¾å¤‡åˆ—è¡¨å¤±è´¥:",d);const b=((e=(o=d==null?void 0:d.response)==null?void 0:o.data)==null?void 0:e.message)||(d==null?void 0:d.message)||"åŠ è½½è®¾å¤‡åˆ—è¡¨å¤±è´¥";k.error(b),B.value=[],x.total=0,U.total=0,U.configured=0,U.unconfigured=0}finally{J.value=!1}},X=async()=>{try{const o={page:1,pageSize:1e4,keyword:g.keyword||void 0,productId:g.productId||void 0,groupId:g.groupId||void 0,status:g.onlineStatus!==null?g.onlineStatus:void 0},e=await W(o);if(e&&e.list){const d=e.list||[];U.total=d.length,U.configured=d.filter(b=>b.alarmConfig).length,U.unconfigured=U.total-U.configured}else U.total=0,U.configured=0,U.unconfigured=0}catch(o){console.error("æ›´æ–°ç»Ÿè®¡æ•°æ®å¤±è´¥:",o)}},ie=async()=>{try{const o=await Ue({});o&&(F.value=o.list||(Array.isArray(o)?o:[]))}catch(o){console.error("åŠ è½½äº§å“åˆ—è¡¨å¤±è´¥:",o)}},de=async()=>{try{const o=await Ie({page:1,pageSize:1e3});o&&o.list&&($.value=o.list||[])}catch(o){console.error("åŠ è½½ç”¨æˆ·åˆ—è¡¨å¤±è´¥:",o)}},H=async o=>{if(!o)return[];if(K.value[o])return K.value[o];try{const e=await Ae(o);if(e){const d=Array.isArray(e)?e:[];return K.value[o]=d,d}return[]}catch(e){return console.error("åŠ è½½ç‰©æ¨¡å‹å±æ€§å¤±è´¥:",e),[]}},re=async o=>{n.device=o,n.visible=!0;const e=await H(o.productId);G.value=e;const d={};e.forEach(b=>{d[b.addr]={enabled:!1,operator:">",threshold:0,level:"warning"}}),o.alarmConfigObj&&o.alarmConfigObj.metrics?(Object.keys(o.alarmConfigObj.metrics).forEach(b=>{d[b]&&(d[b]={...o.alarmConfigObj.metrics[b]})}),n.form={notifyUser:o.alarmConfigObj.notifyUser||null,stackMode:o.alarmConfigObj.stackMode!==!1,mailEnabled:o.alarmConfigObj.mailEnabled||!1,smsEnabled:o.alarmConfigObj.smsEnabled||!1,metrics:d,offlineAlarm:o.alarmConfigObj.offlineAlarm||{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}):o.alarmConfigObj&&o.alarmConfigObj.conditions?(o.alarmConfigObj.conditions.forEach(b=>{d[b.metric]&&(d[b.metric]={enabled:!0,operator:b.operator,threshold:b.threshold,level:o.alarmConfigObj.level||"warning"})}),n.form={notifyUser:o.alarmConfigObj.notifyUsers&&o.alarmConfigObj.notifyUsers.length>0?o.alarmConfigObj.notifyUsers[0]:null,stackMode:o.alarmConfigObj.stackMode!==!1,mailEnabled:o.alarmConfigObj.mailEnabled||!1,smsEnabled:o.alarmConfigObj.smsEnabled||!1,metrics:d}):n.form={notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,metrics:d,offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}},fe=async()=>{var e,d,b,f;const o=Object.entries(n.form.metrics).filter(([u,p])=>p.enabled);if(o.length===0)try{await T({deviceId:n.device.id,alarmConfig:{notifyUser:n.form.notifyUser||null,stackMode:n.form.stackMode,metrics:n.form.metrics},enabled:!1}),k.success("å·²æ’¤é”€è¯¥è®¾å¤‡çš„æ‰€æœ‰æŠ¥è­¦é…ç½®"),n.visible=!1,z();return}catch(u){console.error("é…ç½®å¤±è´¥:",u),k.error("é…ç½®å¤±è´¥ï¼š"+(((d=(e=u.response)==null?void 0:e.data)==null?void 0:d.message)||u.message));return}if(!n.form.notifyUser){k.warning("å¯ç”¨ç›‘æ§æ—¶å¿…é¡»é€‰æ‹©å¤„ç†äºº");return}for(const[u,p]of o){if(!p.operator||p.threshold===null||p.threshold===void 0){k.warning(`ç›‘æ§å±æ€§ "${Y(u)}" çš„é…ç½®ä¸å®Œæ•´ï¼Œè¯·æ£€æŸ¥è¿ç®—ç¬¦å’Œé˜ˆå€¼`);return}if(!p.level){k.warning(`ç›‘æ§å±æ€§ "${Y(u)}" æœªè®¾ç½®æŠ¥è­¦çº§åˆ«`);return}}try{await T({deviceId:n.device.id,alarmConfig:{notifyUser:n.form.notifyUser,stackMode:n.form.stackMode,mailEnabled:n.form.mailEnabled,smsEnabled:n.form.smsEnabled,metrics:n.form.metrics,offlineAlarm:n.form.offlineAlarm},enabled:!0}),k.success("é…ç½®æˆåŠŸ"),n.visible=!1,z()}catch(u){console.error("é…ç½®å¤±è´¥:",u),k.error("é…ç½®å¤±è´¥ï¼š"+(((f=(b=u.response)==null?void 0:b.data)==null?void 0:f.message)||u.message))}},Y=o=>{const e=G.value.find(d=>d.addr===o);return e?e.attrName:o},me=()=>{s.visible=!0,s.productId=null,s.groupId=null,s.availableDevices=[],s.selectedDeviceIds=[],s.selectAll=!1,s.configuredCount=0,s.form={notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,metrics:{},offlineAlarm:{enabled:!1,operator:">",threshold:5,unit:"min",level:"warning"}}},ue=async()=>{if(s.productId){const o=await H(s.productId);q.value=o;const e={};o.forEach(d=>{e[d.addr]={enabled:!1,operator:">",threshold:0,level:"warning"}}),s.form.metrics=e,await Z()}},Z=async()=>{if(s.productId)try{const o={page:1,pageSize:1e4,productId:s.productId,groupId:s.groupId||void 0},e=await W(o);e&&e.list&&(s.availableDevices=(e.list||[]).map(d=>{if(d.alarmConfig)try{d.alarmConfigObj=JSON.parse(d.alarmConfig)}catch{}return{...d,selected:!1}}),Q())}catch(o){console.error("åŠ è½½è®¾å¤‡å¤±è´¥:",o)}},ce=()=>{s.availableDevices.forEach(o=>{o.selected=s.selectAll}),Q()},Q=()=>{s.selectedDeviceIds=s.availableDevices.filter(o=>o.selected).map(o=>o.id),s.configuredCount=s.availableDevices.filter(o=>o.selected&&o.alarmConfig).length,s.selectAll=s.selectedDeviceIds.length===s.availableDevices.length&&s.availableDevices.length>0},pe=async()=>{var e,d,b,f,u,p;if(s.selectedDeviceIds.length===0){k.warning("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªè®¾å¤‡");return}const o=Object.entries(s.form.metrics).filter(([m,M])=>M.enabled);if(o.length===0)try{await oe.confirm(`ç¡®è®¤æ’¤é”€ ${s.selectedDeviceIds.length} å°è®¾å¤‡çš„æ‰€æœ‰æŠ¥è­¦é…ç½®ï¼Ÿ`,"ç¡®è®¤æ“ä½œ",{type:"warning"}),await T({deviceIds:s.selectedDeviceIds,alarmConfig:{notifyUser:s.form.notifyUser||null,stackMode:s.form.stackMode,metrics:s.form.metrics},enabled:!1}),k.success(`å·²æ’¤é”€ ${s.selectedDeviceIds.length} å°è®¾å¤‡çš„æŠ¥è­¦é…ç½®`),s.visible=!1,z();return}catch(m){m!=="cancel"&&(console.error("é…ç½®å¤±è´¥:",m),k.error("é…ç½®å¤±è´¥ï¼š"+(((d=(e=m.response)==null?void 0:e.data)==null?void 0:d.message)||m.message)));return}if(!s.form.notifyUser){k.warning("å¯ç”¨ç›‘æ§æ—¶å¿…é¡»é€‰æ‹©å¤„ç†äºº");return}for(const[m,M]of o){if(!M.operator||M.threshold===null||M.threshold===void 0){const O=((b=q.value.find(A=>A.addr===m))==null?void 0:b.attrName)||m;k.warning(`ç›‘æ§å±æ€§ "${O}" çš„é…ç½®ä¸å®Œæ•´ï¼Œè¯·æ£€æŸ¥è¿ç®—ç¬¦å’Œé˜ˆå€¼`);return}if(!M.level){const O=((f=q.value.find(A=>A.addr===m))==null?void 0:f.attrName)||m;k.warning(`ç›‘æ§å±æ€§ "${O}" æœªè®¾ç½®æŠ¥è­¦çº§åˆ«`);return}}try{await oe.confirm(`ç¡®è®¤ä¸º ${s.selectedDeviceIds.length} å°è®¾å¤‡æ‰¹é‡é…ç½®æŠ¥è­¦é˜ˆå€¼ï¼Ÿ

æ³¨æ„ï¼šå·²é…ç½®è®¾å¤‡çš„åŸæœ‰é˜ˆå€¼å°†è¢«è¦†ç›–ï¼`,"ç¡®è®¤æ“ä½œ",{type:"warning"}),await T({deviceIds:s.selectedDeviceIds,alarmConfig:{notifyUser:s.form.notifyUser,stackMode:s.form.stackMode,mailEnabled:s.form.mailEnabled,smsEnabled:s.form.smsEnabled,metrics:s.form.metrics,offlineAlarm:s.form.offlineAlarm},enabled:!0}),k.success("æ‰¹é‡é…ç½®æˆåŠŸ"),s.visible=!1,z()}catch(m){m!=="cancel"&&(console.error("æ‰¹é‡é…ç½®å¤±è´¥:",m),k.error("é…ç½®å¤±è´¥ï¼š"+(((p=(u=m.response)==null?void 0:u.data)==null?void 0:p.message)||m.message)))}},be=o=>{const e=$.value.find(d=>d.id===o);return e?e.realName||e.username:"-"};return he(()=>{z(),ie(),de()}),(o,e)=>{const d=I("el-icon"),b=I("el-input"),f=I("el-option"),u=I("el-select"),p=I("el-button"),m=I("el-table-column"),M=I("el-table"),O=I("el-pagination"),A=I("el-switch"),P=I("el-input-number"),ee=I("el-dialog"),ge=I("el-alert"),le=I("el-checkbox"),ve=I("el-tag"),ye=_e("loading");return r(),h("div",Ee,[l("div",xe,[e[33]||(e[33]=l("h2",{class:"page-title"},"âš™ï¸ è®¾å¤‡æŠ¥è­¦é˜ˆå€¼é…ç½®",-1)),l("div",Me,[l("span",ze,[e[30]||(e[30]=v("æ€»è®¾å¤‡ ",-1)),l("strong",null,V(U.total),1)]),l("span",Se,[e[31]||(e[31]=v("å·²é…ç½® ",-1)),l("strong",null,V(U.configured),1)]),l("span",Oe,[e[32]||(e[32]=v("æœªé…ç½® ",-1)),l("strong",null,V(U.unconfigured),1)])])]),l("div",je,[t(b,{modelValue:g.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>g.keyword=a),placeholder:"æœç´¢è®¾å¤‡åç§°/è®¾å¤‡ç¼–ç ",class:"search-input",clearable:"",onKeyup:we(z,["enter"])},{prefix:i(()=>[t(d,null,{default:i(()=>[t(R(se))]),_:1})]),_:1},8,["modelValue"]),t(u,{modelValue:g.productId,"onUpdate:modelValue":e[1]||(e[1]=a=>g.productId=a),placeholder:"äº§å“å‹å·",clearable:"",class:"filter-select",style:{width:"180px"}},{default:i(()=>[(r(!0),h(D,null,N(F.value,a=>(r(),y(f,{key:a.id,label:a.productName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(ne,{modelValue:g.groupId,"onUpdate:modelValue":e[2]||(e[2]=a=>g.groupId=a),placeholder:"è®¾å¤‡åˆ†ç»„",clearable:"",class:"filter-select",style:{width:"180px"}},null,8,["modelValue"]),t(u,{modelValue:g.configStatus,"onUpdate:modelValue":e[3]||(e[3]=a=>g.configStatus=a),placeholder:"é…ç½®çŠ¶æ€",clearable:"",class:"filter-select",style:{width:"140px"}},{default:i(()=>[t(f,{label:"å·²é…ç½®",value:"configured"}),t(f,{label:"æœªé…ç½®",value:"unconfigured"})]),_:1},8,["modelValue"]),t(u,{modelValue:g.onlineStatus,"onUpdate:modelValue":e[4]||(e[4]=a=>g.onlineStatus=a),placeholder:"åœ¨çº¿çŠ¶æ€",clearable:"",class:"filter-select",style:{width:"140px"}},{default:i(()=>[t(f,{label:"åœ¨çº¿",value:1}),t(f,{label:"ç¦»çº¿",value:0})]),_:1},8,["modelValue"]),t(p,{type:"primary",onClick:z,icon:R(se),style:{"margin-left":"8px"}},{default:i(()=>[...e[34]||(e[34]=[v("æŸ¥è¯¢",-1)])]),_:1},8,["icon"]),t(p,{type:"primary",onClick:me,icon:R(Ce)},{default:i(()=>[...e[35]||(e[35]=[v("æ‰¹é‡é…ç½®",-1)])]),_:1},8,["icon"])]),l("div",De,[ke((r(),y(M,{data:B.value,stripe:"",style:{width:"100%"}},{default:i(()=>[t(m,{prop:"deviceName",label:"è®¾å¤‡åç§°","min-width":"130","show-overflow-tooltip":""},{default:i(({row:a})=>[l("div",Ne,[l("span",{class:L(["status-dot",a.status===1?"online":"offline"])},null,2),l("span",Be,V(a.deviceName),1)])]),_:1}),t(m,{prop:"deviceCode",label:"è®¾å¤‡ç¼–ç ","min-width":"130","show-overflow-tooltip":""},{default:i(({row:a})=>[l("span",$e,V(a.deviceCode),1)]),_:1}),t(m,{label:"åœ¨çº¿çŠ¶æ€",width:"90",align:"center"},{default:i(({row:a})=>[l("span",{class:L(["status-text",a.status===1?"status-online":"status-offline"])},V(a.status===1?"åœ¨çº¿":"ç¦»çº¿"),3)]),_:1}),t(m,{prop:"productName",label:"äº§å“åç§°","min-width":"140","show-overflow-tooltip":""}),t(m,{prop:"groupName",label:"æ‰€å±åˆ†ç»„","min-width":"110","show-overflow-tooltip":""}),t(m,{label:"é…ç½®çŠ¶æ€",width:"100",align:"center"},{default:i(({row:a})=>[a.alarmConfig?(r(),h("span",qe,"âœ“ å·²é…ç½®")):(r(),h("span",Pe,"âœ— æœªé…ç½®"))]),_:1}),t(m,{label:"å¤„ç†äºº",width:"100","show-overflow-tooltip":""},{default:i(({row:a})=>[a.alarmConfigObj&&a.alarmConfigObj.notifyUser?(r(),h("span",Le,V(be(a.alarmConfigObj.notifyUser)),1)):(r(),h("span",Te,"-"))]),_:1}),t(m,{label:"æ“ä½œ",width:"90",fixed:"right"},{default:i(({row:a})=>[t(p,{type:"primary",link:"",onClick:w=>re(a)},{default:i(()=>[...e[36]||(e[36]=[v("é…ç½®",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ye,J.value]])]),l("div",Je,[t(O,{"current-page":x.page,"onUpdate:currentPage":e[5]||(e[5]=a=>x.page=a),"page-size":x.pageSize,"onUpdate:pageSize":e[6]||(e[6]=a=>x.pageSize=a),total:x.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:z,onCurrentChange:z},null,8,["current-page","page-size","total"])]),t(ee,{modelValue:n.visible,"onUpdate:modelValue":e[16]||(e[16]=a=>n.visible=a),title:"é˜ˆå€¼é…ç½®",width:"900px","close-on-click-modal":!1,top:"3vh",class:"config-dialog"},{footer:i(()=>[l("div",pl,[t(p,{onClick:e[15]||(e[15]=a=>n.visible=!1)},{default:i(()=>[...e[51]||(e[51]=[v("å–æ¶ˆ",-1)])]),_:1}),t(p,{type:"primary",onClick:fe},{default:i(()=>[...e[52]||(e[52]=[v("ä¿å­˜",-1)])]),_:1})])]),default:i(()=>{var a,w,_,ae;return[l("div",Fe,[l("div",Ge,[e[41]||(e[41]=l("h3",{class:"section-title"},"è®¾å¤‡ä¿¡æ¯",-1)),l("div",Ke,[l("div",He,[e[37]||(e[37]=l("span",{class:"info-label"},"è®¾å¤‡åç§°",-1)),l("span",Qe,V((a=n.device)==null?void 0:a.deviceName),1)]),l("div",Re,[e[38]||(e[38]=l("span",{class:"info-label"},"è®¾å¤‡ç¼–ç ",-1)),l("code",We,V((w=n.device)==null?void 0:w.deviceCode),1)]),l("div",Xe,[e[39]||(e[39]=l("span",{class:"info-label"},"äº§å“å‹å·",-1)),l("span",Ye,V((_=n.device)==null?void 0:_.productName),1)]),l("div",Ze,[e[40]||(e[40]=l("span",{class:"info-label"},"æ‰€å±åˆ†ç»„",-1)),l("span",el,V((ae=n.device)==null?void 0:ae.groupName),1)])])]),l("div",ll,[e[49]||(e[49]=l("h3",{class:"section-title"},"å…¨å±€é…ç½®",-1)),l("div",al,[e[42]||(e[42]=l("label",{class:"field-label"},[v(" å¤„ç†äºº "),l("span",{class:"required"},"*")],-1)),t(u,{modelValue:n.form.notifyUser,"onUpdate:modelValue":e[7]||(e[7]=c=>n.form.notifyUser=c),placeholder:"è¯·é€‰æ‹©å¤„ç†äºº",class:"field-select-full"},{default:i(()=>[(r(!0),h(D,null,N($.value,c=>(r(),y(f,{key:c.id,label:c.realName||c.username,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",sl,[e[44]||(e[44]=l("label",{class:"field-label"},"æŠ¥è­¦å †å ",-1)),l("div",tl,[t(A,{modelValue:n.form.stackMode,"onUpdate:modelValue":e[8]||(e[8]=c=>n.form.stackMode=c)},null,8,["modelValue"]),e[43]||(e[43]=l("span",{class:"switch-label"},"å¼€å¯åï¼Œæ¢å¤å‰ä¸ä¼šé‡å¤æŠ¥è­¦",-1))])]),l("div",ol,[e[46]||(e[46]=l("label",{class:"field-label"},"é‚®ä»¶é€šçŸ¥",-1)),l("div",nl,[t(A,{modelValue:n.form.mailEnabled,"onUpdate:modelValue":e[9]||(e[9]=c=>n.form.mailEnabled=c)},null,8,["modelValue"]),e[45]||(e[45]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€é‚®ä»¶é€šçŸ¥å¤„ç†äºº",-1))])]),l("div",il,[e[48]||(e[48]=l("label",{class:"field-label"},"çŸ­ä¿¡é€šçŸ¥",-1)),l("div",dl,[t(A,{modelValue:n.form.smsEnabled,"onUpdate:modelValue":e[10]||(e[10]=c=>n.form.smsEnabled=c)},null,8,["modelValue"]),e[47]||(e[47]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€çŸ­ä¿¡é€šçŸ¥å¤„ç†äººï¼ˆæš‚æœªå®ç°ï¼‰",-1))])])]),l("div",rl,[e[50]||(e[50]=l("h3",{class:"section-title"},"ç‰©æ¨¡å‹ç›‘æ§é…ç½®",-1)),t(M,{data:G.value,border:"",style:{width:"100%"},"max-height":"300px"},{default:i(()=>[t(m,{label:"å±æ€§åç§°",width:"120"},{default:i(({row:c,$index:E})=>[E===0?(r(),h("span",fl,"ç¦»çº¿æŠ¥è­¦")):(r(),h("span",ml,V(c.attrName),1))]),_:1}),t(m,{label:"å¯ç”¨",width:"70",align:"center"},{default:i(({row:c,$index:E})=>[E===0?(r(),y(A,{key:0,modelValue:n.form.offlineAlarm.enabled,"onUpdate:modelValue":e[11]||(e[11]=C=>n.form.offlineAlarm.enabled=C),size:"small"},null,8,["modelValue"])):(r(),y(A,{key:1,modelValue:n.form.metrics[c.addr].enabled,"onUpdate:modelValue":C=>n.form.metrics[c.addr].enabled=C,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1}),t(m,{label:"è¿ç®—ç¬¦",width:"100"},{default:i(({row:c,$index:E})=>[E===0?(r(),y(u,{key:0,modelValue:n.form.offlineAlarm.operator,"onUpdate:modelValue":e[12]||(e[12]=C=>n.form.offlineAlarm.operator=C),disabled:!n.form.offlineAlarm.enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(f,{label:">",value:">"})]),_:1},8,["modelValue","disabled"])):(r(),y(u,{key:1,modelValue:n.form.metrics[c.addr].operator,"onUpdate:modelValue":C=>n.form.metrics[c.addr].operator=C,disabled:!n.form.metrics[c.addr].enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(f,{label:">",value:">"}),t(f,{label:"<",value:"<"}),t(f,{label:"=",value:"="})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1}),t(m,{label:"é˜ˆå€¼",width:"140"},{default:i(({row:c,$index:E})=>[E===0?(r(),y(P,{key:0,modelValue:n.form.offlineAlarm.threshold,"onUpdate:modelValue":e[13]||(e[13]=C=>n.form.offlineAlarm.threshold=C),disabled:!n.form.offlineAlarm.enabled,min:1,precision:0,step:1,size:"small",style:{width:"100%"}},null,8,["modelValue","disabled"])):(r(),y(P,{key:1,modelValue:n.form.metrics[c.addr].threshold,"onUpdate:modelValue":C=>n.form.metrics[c.addr].threshold=C,disabled:!n.form.metrics[c.addr].enabled,precision:2,step:.1,size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1}),t(m,{label:"å•ä½",width:"80",align:"center"},{default:i(({row:c,$index:E})=>[E===0?(r(),h("span",ul,"min")):(r(),h("span",cl,V(c.unit||"-"),1))]),_:1}),t(m,{label:"æŠ¥è­¦çº§åˆ«",width:"140"},{default:i(({row:c,$index:E})=>[E===0?(r(),y(u,{key:0,modelValue:n.form.offlineAlarm.level,"onUpdate:modelValue":e[14]||(e[14]=C=>n.form.offlineAlarm.level=C),disabled:!n.form.offlineAlarm.enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(f,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),t(f,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),t(f,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","disabled"])):(r(),y(u,{key:1,modelValue:n.form.metrics[c.addr].level,"onUpdate:modelValue":C=>n.form.metrics[c.addr].level=C,disabled:!n.form.metrics[c.addr].enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(f,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),t(f,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),t(f,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1})]),_:1},8,["data"])])])]}),_:1},8,["modelValue"]),t(ee,{modelValue:s.visible,"onUpdate:modelValue":e[29]||(e[29]=a=>s.visible=a),title:"æ‰¹é‡é…ç½®",width:"1100px","close-on-click-modal":!1,top:"2vh",class:"batch-dialog"},{footer:i(()=>[l("div",Tl,[t(p,{onClick:e[28]||(e[28]=a=>s.visible=!1)},{default:i(()=>[...e[73]||(e[73]=[v("å–æ¶ˆ",-1)])]),_:1}),t(p,{type:"primary",onClick:pe},{default:i(()=>[...e[74]||(e[74]=[v("ç¡®è®¤é…ç½®",-1)])]),_:1})])]),default:i(()=>[l("div",bl,[t(ge,{type:"warning",closable:!1,class:"warning-box"},{title:i(()=>[...e[53]||(e[53]=[l("strong",null,"é‡è¦æç¤º",-1),l("div",{class:"alert-desc"},[v(" æ‰¹é‡é…ç½®å°†"),l("strong",null,"è¦†ç›–"),v("å·²é€‰è®¾å¤‡çš„åŸæœ‰é…ç½®ï¼Œä»¥æœ¬æ¬¡è®¾ç½®ä¸ºå‡†ã€‚å·²é…ç½®è®¾å¤‡çš„æ—§é˜ˆå€¼å°†å¤±æ•ˆã€‚ ")],-1)])]),_:1}),l("div",gl,[l("div",vl,[e[54]||(e[54]=l("label",{class:"field-label"},[v(" é€‰æ‹©äº§å“ "),l("span",{class:"required"},"*")],-1)),t(u,{modelValue:s.productId,"onUpdate:modelValue":e[17]||(e[17]=a=>s.productId=a),placeholder:"è¯·å…ˆé€‰æ‹©äº§å“å‹å·",onChange:ue,class:"field-select-full"},{default:i(()=>[(r(!0),h(D,null,N(F.value,a=>(r(),y(f,{key:a.id,label:a.productName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[55]||(e[55]=l("div",{class:"field-hint"},"é€‰æ‹©äº§å“åï¼Œç›‘æ§é…ç½®å°†æ ¹æ®è¯¥äº§å“ç‰©æ¨¡å‹åŠ¨æ€åŠ è½½",-1))]),l("div",yl,[e[56]||(e[56]=l("label",{class:"field-label"},"è®¾å¤‡åˆ†ç»„",-1)),t(ne,{modelValue:s.groupId,"onUpdate:modelValue":e[18]||(e[18]=a=>s.groupId=a),placeholder:"å…¨éƒ¨åˆ†ç»„",clearable:"",onChange:Z,class:"field-select-full"},null,8,["modelValue"]),e[57]||(e[57]=l("div",{class:"field-hint"},"ç­›é€‰è¯¥äº§å“ä¸‹æŒ‡å®šåˆ†ç»„çš„è®¾å¤‡",-1))]),l("div",Vl,[e[62]||(e[62]=l("label",{class:"field-label"},[v(" é€‰æ‹©è®¾å¤‡ "),l("span",{class:"required"},"*")],-1)),l("div",hl,[l("div",_l,[t(le,{modelValue:s.selectAll,"onUpdate:modelValue":e[19]||(e[19]=a=>s.selectAll=a),onChange:ce},{default:i(()=>[...e[58]||(e[58]=[v(" å…¨é€‰/å–æ¶ˆå…¨é€‰ ",-1)])]),_:1},8,["modelValue"]),l("span",wl,[e[59]||(e[59]=v(" å·²é€‰æ‹© ",-1)),l("strong",null,V(s.selectedDeviceIds.length),1),e[60]||(e[60]=v(" å°è®¾å¤‡ ",-1)),s.configuredCount>0?(r(),h("span",kl," ï¼ˆå…¶ä¸­ "+V(s.configuredCount)+" å°å·²é…ç½®ï¼‰ ",1)):te("",!0)])]),l("div",Cl,[(r(!0),h(D,null,N(s.availableDevices,a=>(r(),h("div",{key:a.id,class:L(["device-item",{"is-selected":a.selected}])},[t(le,{modelValue:a.selected,"onUpdate:modelValue":w=>a.selected=w,onChange:Q},null,8,["modelValue","onUpdate:modelValue"]),l("div",Ul,[l("div",Al,[l("span",Il,V(a.deviceName),1),a.alarmConfig?(r(),y(ve,{key:0,type:"success",size:"small"},{default:i(()=>[...e[61]||(e[61]=[v("å·²é…ç½®",-1)])]),_:1})):te("",!0)]),l("div",El,[v(V(a.deviceCode)+" | "+V(a.groupName||"æœªåˆ†ç»„")+" | ",1),l("span",{class:L(a.status===1?"text-success":"text-gray")},V(a.status===1?"åœ¨çº¿":"ç¦»çº¿"),3)])])],2))),128))])])])]),e[72]||(e[72]=l("div",{class:"divider-line"},null,-1)),l("div",xl,[e[71]||(e[71]=l("h3",{class:"section-title"},"ç»Ÿä¸€é…ç½®",-1)),l("div",Ml,[e[63]||(e[63]=l("label",{class:"field-label"},[v(" å¤„ç†äºº "),l("span",{class:"required"},"*")],-1)),t(u,{modelValue:s.form.notifyUser,"onUpdate:modelValue":e[20]||(e[20]=a=>s.form.notifyUser=a),placeholder:"è¯·é€‰æ‹©å¤„ç†äºº",class:"field-select-full"},{default:i(()=>[(r(!0),h(D,null,N($.value,a=>(r(),y(f,{key:a.id,label:a.realName||a.username,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",zl,[e[65]||(e[65]=l("label",{class:"field-label"},"æŠ¥è­¦å †å ",-1)),l("div",Sl,[t(A,{modelValue:s.form.stackMode,"onUpdate:modelValue":e[21]||(e[21]=a=>s.form.stackMode=a)},null,8,["modelValue"]),e[64]||(e[64]=l("span",{class:"switch-label"},"å¼€å¯åï¼Œæ¢å¤å‰ä¸ä¼šé‡å¤æŠ¥è­¦",-1))])]),l("div",Ol,[e[67]||(e[67]=l("label",{class:"field-label"},"é‚®ä»¶é€šçŸ¥",-1)),l("div",jl,[t(A,{modelValue:s.form.mailEnabled,"onUpdate:modelValue":e[22]||(e[22]=a=>s.form.mailEnabled=a)},null,8,["modelValue"]),e[66]||(e[66]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€é‚®ä»¶é€šçŸ¥å¤„ç†äºº",-1))])]),l("div",Dl,[e[69]||(e[69]=l("label",{class:"field-label"},"çŸ­ä¿¡é€šçŸ¥",-1)),l("div",Nl,[t(A,{modelValue:s.form.smsEnabled,"onUpdate:modelValue":e[23]||(e[23]=a=>s.form.smsEnabled=a)},null,8,["modelValue"]),e[68]||(e[68]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€çŸ­ä¿¡é€šçŸ¥å¤„ç†äººï¼ˆæš‚æœªå®ç°ï¼‰",-1))])]),l("div",Bl,[e[70]||(e[70]=l("label",{class:"field-label"},[v(" ç‰©æ¨¡å‹ç›‘æ§é…ç½® "),l("span",{class:"required"},"*")],-1)),t(M,{data:q.value,border:"",style:{width:"100%"},"max-height":"300px"},{default:i(()=>[t(m,{label:"å±æ€§åç§°",width:"120"},{default:i(({row:a,$index:w})=>[w===0?(r(),h("span",$l,"ç¦»çº¿æŠ¥è­¦")):(r(),h("span",ql,V(a.attrName),1))]),_:1}),t(m,{label:"å¯ç”¨",width:"70",align:"center"},{default:i(({row:a,$index:w})=>[w===0?(r(),y(A,{key:0,modelValue:s.form.offlineAlarm.enabled,"onUpdate:modelValue":e[24]||(e[24]=_=>s.form.offlineAlarm.enabled=_),size:"small"},null,8,["modelValue"])):(r(),y(A,{key:1,modelValue:s.form.metrics[a.addr].enabled,"onUpdate:modelValue":_=>s.form.metrics[a.addr].enabled=_,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1}),t(m,{label:"è¿ç®—ç¬¦",width:"100"},{default:i(({row:a,$index:w})=>[w===0?(r(),y(u,{key:0,modelValue:s.form.offlineAlarm.operator,"onUpdate:modelValue":e[25]||(e[25]=_=>s.form.offlineAlarm.operator=_),disabled:!s.form.offlineAlarm.enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(f,{label:">",value:">"})]),_:1},8,["modelValue","disabled"])):(r(),y(u,{key:1,modelValue:s.form.metrics[a.addr].operator,"onUpdate:modelValue":_=>s.form.metrics[a.addr].operator=_,disabled:!s.form.metrics[a.addr].enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(f,{label:">",value:">"}),t(f,{label:"<",value:"<"}),t(f,{label:"=",value:"="})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1}),t(m,{label:"é˜ˆå€¼",width:"140"},{default:i(({row:a,$index:w})=>[w===0?(r(),y(P,{key:0,modelValue:s.form.offlineAlarm.threshold,"onUpdate:modelValue":e[26]||(e[26]=_=>s.form.offlineAlarm.threshold=_),disabled:!s.form.offlineAlarm.enabled,min:1,precision:0,step:1,size:"small",style:{width:"100%"}},null,8,["modelValue","disabled"])):(r(),y(P,{key:1,modelValue:s.form.metrics[a.addr].threshold,"onUpdate:modelValue":_=>s.form.metrics[a.addr].threshold=_,disabled:!s.form.metrics[a.addr].enabled,precision:2,step:.1,size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1}),t(m,{label:"å•ä½",width:"80",align:"center"},{default:i(({row:a,$index:w})=>[w===0?(r(),h("span",Pl,"min")):(r(),h("span",Ll,V(a.unit||"-"),1))]),_:1}),t(m,{label:"æŠ¥è­¦çº§åˆ«",width:"140"},{default:i(({row:a,$index:w})=>[w===0?(r(),y(u,{key:0,modelValue:s.form.offlineAlarm.level,"onUpdate:modelValue":e[27]||(e[27]=_=>s.form.offlineAlarm.level=_),disabled:!s.form.offlineAlarm.enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(f,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),t(f,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),t(f,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","disabled"])):(r(),y(u,{key:1,modelValue:s.form.metrics[a.addr].level,"onUpdate:modelValue":_=>s.form.metrics[a.addr].level=_,disabled:!s.form.metrics[a.addr].enabled,size:"small",style:{width:"100%"}},{default:i(()=>[t(f,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),t(f,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),t(f,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1})]),_:1},8,["data"])])])])]),_:1},8,["modelValue"])])}}},Yl=Ve(Jl,[["__scopeId","data-v-a5f21b8c"]]);export{Yl as default};
