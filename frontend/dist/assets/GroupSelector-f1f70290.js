import{g as v}from"./group-9a3bc4f2.js";import{_ as S,r as i,y as f,z as b,c as G,o as x,k as V,E as B}from"./index-60c90437.js";const k={__name:"GroupSelector",props:{modelValue:{type:Number,default:null},placeholder:{type:String,default:"请选择所属分组"},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},defaultExpandAll:{type:Boolean,default:!0},autoLoad:{type:Boolean,default:!0}},emits:["update:modelValue","change","loaded"],setup(t,{expose:m,emit:g}){const c=t,n=g,o=i([]),s=i(!1),u=f({get:()=>c.modelValue,set:e=>n("update:modelValue",e)}),d=async()=>{try{s.value=!0,console.log("=== GroupSelector 开始加载分组 ===");const e=await v();console.log("=== GroupSelector 接口返回 ===",JSON.stringify(e,null,2)),o.value=e.tree||[],console.log("=== GroupSelector 树形数据 ===",JSON.stringify(o.value,null,2)),console.log("=== GroupSelector 分组数量 ===",o.value.length),n("loaded",o.value)}catch(e){console.error("加载分组数据失败:",e),B.error("加载分组数据失败")}finally{s.value=!1}},_=f(()=>{const e=r=>Array.isArray(r)?r.map(l=>{const p={id:l.id,name:l.name,label:l.name,value:l.id};return l.children&&l.children.length>0&&(p.children=e(l.children)),p}):[],a=e(o.value);return console.log("GroupSelector - 构建的树形数据:",a),a});m({loadGroups:d,groupsData:o});const y=(e,a)=>e?a.name.toLowerCase().includes(e.toLowerCase()):!0,h=e=>{n("change",e)};return b(()=>{c.autoLoad&&d()}),(e,a)=>{const r=G("el-tree-select");return x(),V(r,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=l=>u.value=l),data:_.value,"node-key":"id",props:{label:"name",children:"children"},"render-after-expand":!1,"default-expand-all":t.defaultExpandAll,"check-strictly":"",filterable:"","filter-node-method":y,placeholder:t.placeholder,disabled:t.disabled,clearable:t.clearable,class:"group-selector","popper-class":"group-selector-dropdown",onChange:h},null,8,["modelValue","data","default-expand-all","placeholder","disabled","clearable"])}}},A=S(k,[["__scopeId","data-v-e1e349cd"]]);export{A as G};
