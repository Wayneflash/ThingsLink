import{_ as ye,b as M,c as N,v as _e,d as h,y as Ve,o as y,e as U,f as l,q as g,t as v,g as a,w as i,h as he,i as K,B as we,I as S,E as _,J as se,F as O,C as j,L as Ce,z as $,A as ae,M as te}from"./index-d25c41ea.js";import{g as H}from"./device-d263828f.js";import{g as Ue,a as ke}from"./product-a510e37a.js";import{g as Ie}from"./user-b40b7fed.js";import{c as q}from"./alarm-cff2fdbb.js";import{G as oe}from"./GroupSelector-9b63f6bd.js";import"./group-a2fe2bd7.js";const Ee={class:"alarm-config-page"},xe={class:"page-header"},Me={class:"stats-quick"},Se={class:"stat-item"},De={class:"stat-item active"},Ne={class:"stat-item inactive"},Oe={class:"filter-bar"},je={class:"table-container"},ze={class:"device-name-cell"},Ae={class:"device-name-text"},Be={class:"device-code-text"},$e={key:0,class:"tag configured"},qe={key:1,class:"tag unconfigured"},Pe={key:0,class:"handler-user-text"},Le={key:1,class:"empty-text"},Te={class:"pagination-wrapper"},Je={class:"dialog-body"},Fe={class:"info-section"},Ge={class:"info-grid"},Ke={class:"info-item"},He={class:"info-value"},Qe={class:"info-item"},Re={class:"info-value code"},We={class:"info-item"},Xe={class:"info-value"},Ye={class:"info-item"},Ze={class:"info-value"},el={class:"form-section"},ll={class:"form-field"},sl={class:"form-field"},al={class:"switch-field"},tl={class:"form-field"},ol={class:"switch-field"},nl={class:"form-field"},il={class:"switch-field"},dl={class:"form-section"},rl={class:"field-unit"},ul={class:"dialog-footer"},fl={class:"dialog-body"},ml={class:"form-section"},cl={class:"form-field"},pl={class:"form-field"},bl={class:"form-field"},gl={class:"device-select-area"},vl={class:"select-header"},yl={class:"select-info"},_l={key:0,class:"warn-text"},Vl={class:"device-list"},hl={class:"device-details"},wl={class:"device-title-row"},Cl={class:"device-title-text"},Ul={class:"device-meta-text"},kl={class:"form-section"},Il={class:"form-field"},El={class:"form-field"},xl={class:"switch-field"},Ml={class:"form-field"},Sl={class:"switch-field"},Dl={class:"form-field"},Nl={class:"switch-field"},Ol={class:"form-field"},jl={class:"field-unit"},zl={class:"dialog-footer"},Al={__name:"AlarmThresholdConfig",setup(Bl){const P=M(!1),z=M([]),L=M([]),A=M([]),T=M([]),B=M([]),J=M({}),V=N({total:0,configured:0,unconfigured:0}),b=N({keyword:"",productId:null,groupId:null,configStatus:null,onlineStatus:null}),k=N({page:1,pageSize:20,total:0}),n=N({visible:!1,device:null,form:{level:"warning",conditions:[{metric:"",operator:">",threshold:0}],notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1}}),t=N({visible:!1,productId:null,groupId:null,availableDevices:[],selectedDeviceIds:[],selectAll:!1,configuredCount:0,form:{level:"warning",conditions:[{metric:"",operator:">",threshold:0}],notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1}}),E=async()=>{var o,e;P.value=!0;try{const d={page:k.page,pageSize:k.pageSize,keyword:b.keyword||void 0,productId:b.productId||void 0,groupId:b.groupId||void 0,status:b.onlineStatus!==null?b.onlineStatus:void 0},c=await H(d);if(c&&c.list){let u=c.list||[];u=u.map(f=>{if(f.alarmConfig)try{f.alarmConfigObj=JSON.parse(f.alarmConfig)}catch{f.alarmConfigObj=null}return f}),b.configStatus&&(u=u.filter(f=>b.configStatus==="configured"?f.alarmConfig:b.configStatus==="unconfigured"?!f.alarmConfig:!0)),z.value=u,k.total=c.total||0;const p=[...new Set(u.map(f=>f.productId).filter(Boolean))];await Promise.all(p.map(f=>F(f))),Q()}else z.value=[],k.total=0,Q()}catch(d){console.error("åŠ è½½è®¾å¤‡åˆ—è¡¨å¤±è´¥:",d);const c=((e=(o=d==null?void 0:d.response)==null?void 0:o.data)==null?void 0:e.message)||(d==null?void 0:d.message)||"åŠ è½½è®¾å¤‡åˆ—è¡¨å¤±è´¥";_.error(c),z.value=[],k.total=0,V.total=0,V.configured=0,V.unconfigured=0}finally{P.value=!1}},Q=async()=>{try{const o={page:1,pageSize:1e4,keyword:b.keyword||void 0,productId:b.productId||void 0,groupId:b.groupId||void 0,status:b.onlineStatus!==null?b.onlineStatus:void 0},e=await H(o);if(e&&e.list){const d=e.list||[];V.total=d.length,V.configured=d.filter(c=>c.alarmConfig).length,V.unconfigured=V.total-V.configured}else V.total=0,V.configured=0,V.unconfigured=0}catch(o){console.error("æ›´æ–°ç»Ÿè®¡æ•°æ®å¤±è´¥:",o)}},ne=async()=>{try{const o=await Ue({});o&&(L.value=o.list||(Array.isArray(o)?o:[]))}catch(o){console.error("åŠ è½½äº§å“åˆ—è¡¨å¤±è´¥:",o)}},ie=async()=>{try{const o=await Ie({page:1,pageSize:1e3});o&&o.list&&(A.value=o.list||[])}catch(o){console.error("åŠ è½½ç”¨æˆ·åˆ—è¡¨å¤±è´¥:",o)}},F=async o=>{if(!o)return[];if(J.value[o])return J.value[o];try{const e=await ke(o);if(e){const d=Array.isArray(e)?e:[];return J.value[o]=d,d}return[]}catch(e){return console.error("åŠ è½½ç‰©æ¨¡å‹å±æ€§å¤±è´¥:",e),[]}},de=async o=>{n.device=o,n.visible=!0;const e=await F(o.productId);T.value=e;const d={};e.forEach(c=>{d[c.addr]={enabled:!1,operator:">",threshold:0,level:"warning"}}),o.alarmConfigObj&&o.alarmConfigObj.metrics?(Object.keys(o.alarmConfigObj.metrics).forEach(c=>{d[c]&&(d[c]={...o.alarmConfigObj.metrics[c]})}),n.form={notifyUser:o.alarmConfigObj.notifyUser||null,stackMode:o.alarmConfigObj.stackMode!==!1,mailEnabled:o.alarmConfigObj.mailEnabled||!1,smsEnabled:o.alarmConfigObj.smsEnabled||!1,metrics:d}):o.alarmConfigObj&&o.alarmConfigObj.conditions?(o.alarmConfigObj.conditions.forEach(c=>{d[c.metric]&&(d[c.metric]={enabled:!0,operator:c.operator,threshold:c.threshold,level:o.alarmConfigObj.level||"warning"})}),n.form={notifyUser:o.alarmConfigObj.notifyUsers&&o.alarmConfigObj.notifyUsers.length>0?o.alarmConfigObj.notifyUsers[0]:null,stackMode:o.alarmConfigObj.stackMode!==!1,mailEnabled:o.alarmConfigObj.mailEnabled||!1,smsEnabled:o.alarmConfigObj.smsEnabled||!1,metrics:d}):n.form={notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,metrics:d}},re=async()=>{var e,d,c,u;const o=Object.entries(n.form.metrics).filter(([p,f])=>f.enabled);if(o.length===0)try{await q({deviceId:n.device.id,alarmConfig:{notifyUser:n.form.notifyUser||null,stackMode:n.form.stackMode,metrics:n.form.metrics},enabled:!1}),_.success("å·²æ’¤é”€è¯¥è®¾å¤‡çš„æ‰€æœ‰æŠ¥è­¦é…ç½®"),n.visible=!1,E();return}catch(p){console.error("é…ç½®å¤±è´¥:",p),_.error("é…ç½®å¤±è´¥ï¼š"+(((d=(e=p.response)==null?void 0:e.data)==null?void 0:d.message)||p.message));return}if(!n.form.notifyUser){_.warning("å¯ç”¨ç›‘æ§æ—¶å¿…é¡»é€‰æ‹©å¤„ç†äºº");return}for(const[p,f]of o){if(!f.operator||f.threshold===null||f.threshold===void 0){_.warning(`ç›‘æ§å±æ€§ "${R(p)}" çš„é…ç½®ä¸å®Œæ•´ï¼Œè¯·æ£€æŸ¥è¿ç®—ç¬¦å’Œé˜ˆå€¼`);return}if(!f.level){_.warning(`ç›‘æ§å±æ€§ "${R(p)}" æœªè®¾ç½®æŠ¥è­¦çº§åˆ«`);return}}try{await q({deviceId:n.device.id,alarmConfig:{notifyUser:n.form.notifyUser,stackMode:n.form.stackMode,mailEnabled:n.form.mailEnabled,smsEnabled:n.form.smsEnabled,metrics:n.form.metrics},enabled:!0}),_.success("é…ç½®æˆåŠŸ"),n.visible=!1,E()}catch(p){console.error("é…ç½®å¤±è´¥:",p),_.error("é…ç½®å¤±è´¥ï¼š"+(((u=(c=p.response)==null?void 0:c.data)==null?void 0:u.message)||p.message))}},R=o=>{const e=T.value.find(d=>d.addr===o);return e?e.attrName:o},ue=()=>{t.visible=!0,t.productId=null,t.groupId=null,t.availableDevices=[],t.selectedDeviceIds=[],t.selectAll=!1,t.configuredCount=0,t.form={notifyUser:null,stackMode:!0,mailEnabled:!1,smsEnabled:!1,metrics:{}}},fe=async()=>{if(t.productId){const o=await F(t.productId);B.value=o;const e={};o.forEach(d=>{e[d.addr]={enabled:!1,operator:">",threshold:0,level:"warning"}}),t.form.metrics=e,await W()}},W=async()=>{if(t.productId)try{const o={page:1,pageSize:1e4,productId:t.productId,groupId:t.groupId||void 0},e=await H(o);e&&e.list&&(t.availableDevices=(e.list||[]).map(d=>{if(d.alarmConfig)try{d.alarmConfigObj=JSON.parse(d.alarmConfig)}catch{}return{...d,selected:!1}}),G())}catch(o){console.error("åŠ è½½è®¾å¤‡å¤±è´¥:",o)}},me=()=>{t.availableDevices.forEach(o=>{o.selected=t.selectAll}),G()},G=()=>{t.selectedDeviceIds=t.availableDevices.filter(o=>o.selected).map(o=>o.id),t.configuredCount=t.availableDevices.filter(o=>o.selected&&o.alarmConfig).length,t.selectAll=t.selectedDeviceIds.length===t.availableDevices.length&&t.availableDevices.length>0},ce=async()=>{var e,d,c,u,p,f;if(t.selectedDeviceIds.length===0){_.warning("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªè®¾å¤‡");return}const o=Object.entries(t.form.metrics).filter(([r,I])=>I.enabled);if(o.length===0)try{await te.confirm(`ç¡®è®¤æ’¤é”€ ${t.selectedDeviceIds.length} å°è®¾å¤‡çš„æ‰€æœ‰æŠ¥è­¦é…ç½®ï¼Ÿ`,"ç¡®è®¤æ“ä½œ",{type:"warning"}),await q({deviceIds:t.selectedDeviceIds,alarmConfig:{notifyUser:t.form.notifyUser||null,stackMode:t.form.stackMode,metrics:t.form.metrics},enabled:!1}),_.success(`å·²æ’¤é”€ ${t.selectedDeviceIds.length} å°è®¾å¤‡çš„æŠ¥è­¦é…ç½®`),t.visible=!1,E();return}catch(r){r!=="cancel"&&(console.error("é…ç½®å¤±è´¥:",r),_.error("é…ç½®å¤±è´¥ï¼š"+(((d=(e=r.response)==null?void 0:e.data)==null?void 0:d.message)||r.message)));return}if(!t.form.notifyUser){_.warning("å¯ç”¨ç›‘æ§æ—¶å¿…é¡»é€‰æ‹©å¤„ç†äºº");return}for(const[r,I]of o){if(!I.operator||I.threshold===null||I.threshold===void 0){const D=((c=B.value.find(C=>C.addr===r))==null?void 0:c.attrName)||r;_.warning(`ç›‘æ§å±æ€§ "${D}" çš„é…ç½®ä¸å®Œæ•´ï¼Œè¯·æ£€æŸ¥è¿ç®—ç¬¦å’Œé˜ˆå€¼`);return}if(!I.level){const D=((u=B.value.find(C=>C.addr===r))==null?void 0:u.attrName)||r;_.warning(`ç›‘æ§å±æ€§ "${D}" æœªè®¾ç½®æŠ¥è­¦çº§åˆ«`);return}}try{await te.confirm(`ç¡®è®¤ä¸º ${t.selectedDeviceIds.length} å°è®¾å¤‡æ‰¹é‡é…ç½®æŠ¥è­¦é˜ˆå€¼ï¼Ÿ

æ³¨æ„ï¼šå·²é…ç½®è®¾å¤‡çš„åŸæœ‰é˜ˆå€¼å°†è¢«è¦†ç›–ï¼`,"ç¡®è®¤æ“ä½œ",{type:"warning"}),await q({deviceIds:t.selectedDeviceIds,alarmConfig:{notifyUser:t.form.notifyUser,stackMode:t.form.stackMode,mailEnabled:t.form.mailEnabled,smsEnabled:t.form.smsEnabled,metrics:t.form.metrics},enabled:!0}),_.success("æ‰¹é‡é…ç½®æˆåŠŸ"),t.visible=!1,E()}catch(r){r!=="cancel"&&(console.error("æ‰¹é‡é…ç½®å¤±è´¥:",r),_.error("é…ç½®å¤±è´¥ï¼š"+(((f=(p=r.response)==null?void 0:p.data)==null?void 0:f.message)||r.message)))}},pe=o=>{const e=A.value.find(d=>d.id===o);return e?e.realName||e.username:"-"};return _e(()=>{E(),ne(),ie()}),(o,e)=>{const d=h("el-icon"),c=h("el-input"),u=h("el-option"),p=h("el-select"),f=h("el-button"),r=h("el-table-column"),I=h("el-table"),D=h("el-pagination"),C=h("el-switch"),X=h("el-input-number"),Y=h("el-dialog"),be=h("el-alert"),Z=h("el-checkbox"),ge=h("el-tag"),ve=Ve("loading");return y(),U("div",Ee,[l("div",xe,[e[25]||(e[25]=l("h2",{class:"page-title"},"âš™ï¸ è®¾å¤‡æŠ¥è­¦é˜ˆå€¼é…ç½®",-1)),l("div",Me,[l("span",Se,[e[22]||(e[22]=g("æ€»è®¾å¤‡ ",-1)),l("strong",null,v(V.total),1)]),l("span",De,[e[23]||(e[23]=g("å·²é…ç½® ",-1)),l("strong",null,v(V.configured),1)]),l("span",Ne,[e[24]||(e[24]=g("æœªé…ç½® ",-1)),l("strong",null,v(V.unconfigured),1)])])]),l("div",Oe,[a(c,{modelValue:b.keyword,"onUpdate:modelValue":e[0]||(e[0]=s=>b.keyword=s),placeholder:"æœç´¢è®¾å¤‡åç§°/è®¾å¤‡ç¼–ç ",class:"search-input",clearable:"",onKeyup:he(E,["enter"])},{prefix:i(()=>[a(d,null,{default:i(()=>[a(K(se))]),_:1})]),_:1},8,["modelValue"]),a(p,{modelValue:b.productId,"onUpdate:modelValue":e[1]||(e[1]=s=>b.productId=s),placeholder:"äº§å“å‹å·",clearable:"",class:"filter-select",style:{width:"180px"}},{default:i(()=>[(y(!0),U(O,null,j(L.value,s=>(y(),S(u,{key:s.id,label:s.productName,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(oe,{modelValue:b.groupId,"onUpdate:modelValue":e[2]||(e[2]=s=>b.groupId=s),placeholder:"è®¾å¤‡åˆ†ç»„",clearable:"",class:"filter-select",style:{width:"180px"}},null,8,["modelValue"]),a(p,{modelValue:b.configStatus,"onUpdate:modelValue":e[3]||(e[3]=s=>b.configStatus=s),placeholder:"é…ç½®çŠ¶æ€",clearable:"",class:"filter-select",style:{width:"140px"}},{default:i(()=>[a(u,{label:"å·²é…ç½®",value:"configured"}),a(u,{label:"æœªé…ç½®",value:"unconfigured"})]),_:1},8,["modelValue"]),a(p,{modelValue:b.onlineStatus,"onUpdate:modelValue":e[4]||(e[4]=s=>b.onlineStatus=s),placeholder:"åœ¨çº¿çŠ¶æ€",clearable:"",class:"filter-select",style:{width:"140px"}},{default:i(()=>[a(u,{label:"åœ¨çº¿",value:1}),a(u,{label:"ç¦»çº¿",value:0})]),_:1},8,["modelValue"]),a(f,{type:"primary",onClick:E,icon:K(se),style:{"margin-left":"8px"}},{default:i(()=>[...e[26]||(e[26]=[g("æŸ¥è¯¢",-1)])]),_:1},8,["icon"]),a(f,{type:"primary",onClick:ue,icon:K(Ce)},{default:i(()=>[...e[27]||(e[27]=[g("æ‰¹é‡é…ç½®",-1)])]),_:1},8,["icon"])]),l("div",je,[we((y(),S(I,{data:z.value,stripe:"",style:{width:"100%"}},{default:i(()=>[a(r,{prop:"deviceName",label:"è®¾å¤‡åç§°","min-width":"130","show-overflow-tooltip":""},{default:i(({row:s})=>[l("div",ze,[l("span",{class:$(["status-dot",s.status===1?"online":"offline"])},null,2),l("span",Ae,v(s.deviceName),1)])]),_:1}),a(r,{prop:"deviceCode",label:"è®¾å¤‡ç¼–ç ","min-width":"130","show-overflow-tooltip":""},{default:i(({row:s})=>[l("span",Be,v(s.deviceCode),1)]),_:1}),a(r,{label:"åœ¨çº¿çŠ¶æ€",width:"90",align:"center"},{default:i(({row:s})=>[l("span",{class:$(["status-text",s.status===1?"status-online":"status-offline"])},v(s.status===1?"åœ¨çº¿":"ç¦»çº¿"),3)]),_:1}),a(r,{prop:"productName",label:"äº§å“åç§°","min-width":"140","show-overflow-tooltip":""}),a(r,{prop:"groupName",label:"æ‰€å±åˆ†ç»„","min-width":"110","show-overflow-tooltip":""}),a(r,{label:"é…ç½®çŠ¶æ€",width:"100",align:"center"},{default:i(({row:s})=>[s.alarmConfig?(y(),U("span",$e,"âœ“ å·²é…ç½®")):(y(),U("span",qe,"âœ— æœªé…ç½®"))]),_:1}),a(r,{label:"å¤„ç†äºº",width:"100","show-overflow-tooltip":""},{default:i(({row:s})=>[s.alarmConfigObj&&s.alarmConfigObj.notifyUser?(y(),U("span",Pe,v(pe(s.alarmConfigObj.notifyUser)),1)):(y(),U("span",Le,"-"))]),_:1}),a(r,{label:"æ“ä½œ",width:"90",fixed:"right"},{default:i(({row:s})=>[a(f,{type:"primary",link:"",onClick:w=>de(s)},{default:i(()=>[...e[28]||(e[28]=[g("é…ç½®",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ve,P.value]])]),l("div",Te,[a(D,{"current-page":k.page,"onUpdate:currentPage":e[5]||(e[5]=s=>k.page=s),"page-size":k.pageSize,"onUpdate:pageSize":e[6]||(e[6]=s=>k.pageSize=s),total:k.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:E,onCurrentChange:E},null,8,["current-page","page-size","total"])]),a(Y,{modelValue:n.visible,"onUpdate:modelValue":e[12]||(e[12]=s=>n.visible=s),title:"é˜ˆå€¼é…ç½®",width:"900px","close-on-click-modal":!1,top:"3vh",class:"config-dialog"},{footer:i(()=>[l("div",ul,[a(f,{onClick:e[11]||(e[11]=s=>n.visible=!1)},{default:i(()=>[...e[43]||(e[43]=[g("å–æ¶ˆ",-1)])]),_:1}),a(f,{type:"primary",onClick:re},{default:i(()=>[...e[44]||(e[44]=[g("ä¿å­˜",-1)])]),_:1})])]),default:i(()=>{var s,w,ee,le;return[l("div",Je,[l("div",Fe,[e[33]||(e[33]=l("h3",{class:"section-title"},"è®¾å¤‡ä¿¡æ¯",-1)),l("div",Ge,[l("div",Ke,[e[29]||(e[29]=l("span",{class:"info-label"},"è®¾å¤‡åç§°",-1)),l("span",He,v((s=n.device)==null?void 0:s.deviceName),1)]),l("div",Qe,[e[30]||(e[30]=l("span",{class:"info-label"},"è®¾å¤‡ç¼–ç ",-1)),l("code",Re,v((w=n.device)==null?void 0:w.deviceCode),1)]),l("div",We,[e[31]||(e[31]=l("span",{class:"info-label"},"äº§å“å‹å·",-1)),l("span",Xe,v((ee=n.device)==null?void 0:ee.productName),1)]),l("div",Ye,[e[32]||(e[32]=l("span",{class:"info-label"},"æ‰€å±åˆ†ç»„",-1)),l("span",Ze,v((le=n.device)==null?void 0:le.groupName),1)])])]),l("div",el,[e[41]||(e[41]=l("h3",{class:"section-title"},"å…¨å±€é…ç½®",-1)),l("div",ll,[e[34]||(e[34]=l("label",{class:"field-label"},[g(" å¤„ç†äºº "),l("span",{class:"required"},"*")],-1)),a(p,{modelValue:n.form.notifyUser,"onUpdate:modelValue":e[7]||(e[7]=m=>n.form.notifyUser=m),placeholder:"è¯·é€‰æ‹©å¤„ç†äºº",class:"field-select-full"},{default:i(()=>[(y(!0),U(O,null,j(A.value,m=>(y(),S(u,{key:m.id,label:m.realName||m.username,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",sl,[e[36]||(e[36]=l("label",{class:"field-label"},"æŠ¥è­¦å †å ",-1)),l("div",al,[a(C,{modelValue:n.form.stackMode,"onUpdate:modelValue":e[8]||(e[8]=m=>n.form.stackMode=m)},null,8,["modelValue"]),e[35]||(e[35]=l("span",{class:"switch-label"},"å¼€å¯åï¼Œæ¢å¤å‰ä¸ä¼šé‡å¤æŠ¥è­¦",-1))])]),l("div",tl,[e[38]||(e[38]=l("label",{class:"field-label"},"é‚®ä»¶é€šçŸ¥",-1)),l("div",ol,[a(C,{modelValue:n.form.mailEnabled,"onUpdate:modelValue":e[9]||(e[9]=m=>n.form.mailEnabled=m)},null,8,["modelValue"]),e[37]||(e[37]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€é‚®ä»¶é€šçŸ¥å¤„ç†äºº",-1))])]),l("div",nl,[e[40]||(e[40]=l("label",{class:"field-label"},"çŸ­ä¿¡é€šçŸ¥",-1)),l("div",il,[a(C,{modelValue:n.form.smsEnabled,"onUpdate:modelValue":e[10]||(e[10]=m=>n.form.smsEnabled=m)},null,8,["modelValue"]),e[39]||(e[39]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€çŸ­ä¿¡é€šçŸ¥å¤„ç†äººï¼ˆæš‚æœªå®ç°ï¼‰",-1))])])]),l("div",dl,[e[42]||(e[42]=l("h3",{class:"section-title"},"ç‰©æ¨¡å‹ç›‘æ§é…ç½®",-1)),a(I,{data:T.value,border:"",style:{width:"100%"},"max-height":"300px"},{default:i(()=>[a(r,{prop:"attrName",label:"å±æ€§åç§°",width:"120"}),a(r,{label:"å¯ç”¨",width:"70",align:"center"},{default:i(({row:m})=>[a(C,{modelValue:n.form.metrics[m.addr].enabled,"onUpdate:modelValue":x=>n.form.metrics[m.addr].enabled=x,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(r,{label:"è¿ç®—ç¬¦",width:"100"},{default:i(({row:m})=>[a(p,{modelValue:n.form.metrics[m.addr].operator,"onUpdate:modelValue":x=>n.form.metrics[m.addr].operator=x,disabled:!n.form.metrics[m.addr].enabled,size:"small"},{default:i(()=>[a(u,{label:">",value:">"}),a(u,{label:"<",value:"<"}),a(u,{label:"=",value:"="})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(r,{label:"é˜ˆå€¼",width:"140"},{default:i(({row:m})=>[a(X,{modelValue:n.form.metrics[m.addr].threshold,"onUpdate:modelValue":x=>n.form.metrics[m.addr].threshold=x,disabled:!n.form.metrics[m.addr].enabled,precision:2,step:.1,size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(r,{label:"å•ä½",width:"80",align:"center"},{default:i(({row:m})=>[l("span",rl,v(m.unit||"-"),1)]),_:1}),a(r,{label:"æŠ¥è­¦çº§åˆ«",width:"140"},{default:i(({row:m})=>[a(p,{modelValue:n.form.metrics[m.addr].level,"onUpdate:modelValue":x=>n.form.metrics[m.addr].level=x,disabled:!n.form.metrics[m.addr].enabled,size:"small"},{default:i(()=>[a(u,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),a(u,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),a(u,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["data"])])])]}),_:1},8,["modelValue"]),a(Y,{modelValue:t.visible,"onUpdate:modelValue":e[21]||(e[21]=s=>t.visible=s),title:"æ‰¹é‡é…ç½®",width:"1100px","close-on-click-modal":!1,top:"2vh",class:"batch-dialog"},{footer:i(()=>[l("div",zl,[a(f,{onClick:e[20]||(e[20]=s=>t.visible=!1)},{default:i(()=>[...e[65]||(e[65]=[g("å–æ¶ˆ",-1)])]),_:1}),a(f,{type:"primary",onClick:ce},{default:i(()=>[...e[66]||(e[66]=[g("ç¡®è®¤é…ç½®",-1)])]),_:1})])]),default:i(()=>[l("div",fl,[a(be,{type:"warning",closable:!1,class:"warning-box"},{title:i(()=>[...e[45]||(e[45]=[l("strong",null,"é‡è¦æç¤º",-1),l("div",{class:"alert-desc"},[g(" æ‰¹é‡é…ç½®å°†"),l("strong",null,"è¦†ç›–"),g("å·²é€‰è®¾å¤‡çš„åŸæœ‰é…ç½®ï¼Œä»¥æœ¬æ¬¡è®¾ç½®ä¸ºå‡†ã€‚å·²é…ç½®è®¾å¤‡çš„æ—§é˜ˆå€¼å°†å¤±æ•ˆã€‚ ")],-1)])]),_:1}),l("div",ml,[l("div",cl,[e[46]||(e[46]=l("label",{class:"field-label"},[g(" é€‰æ‹©äº§å“ "),l("span",{class:"required"},"*")],-1)),a(p,{modelValue:t.productId,"onUpdate:modelValue":e[13]||(e[13]=s=>t.productId=s),placeholder:"è¯·å…ˆé€‰æ‹©äº§å“å‹å·",onChange:fe,class:"field-select-full"},{default:i(()=>[(y(!0),U(O,null,j(L.value,s=>(y(),S(u,{key:s.id,label:s.productName,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[47]||(e[47]=l("div",{class:"field-hint"},"é€‰æ‹©äº§å“åï¼Œç›‘æ§é…ç½®å°†æ ¹æ®è¯¥äº§å“ç‰©æ¨¡å‹åŠ¨æ€åŠ è½½",-1))]),l("div",pl,[e[48]||(e[48]=l("label",{class:"field-label"},"è®¾å¤‡åˆ†ç»„",-1)),a(oe,{modelValue:t.groupId,"onUpdate:modelValue":e[14]||(e[14]=s=>t.groupId=s),placeholder:"å…¨éƒ¨åˆ†ç»„",clearable:"",onChange:W,class:"field-select-full"},null,8,["modelValue"]),e[49]||(e[49]=l("div",{class:"field-hint"},"ç­›é€‰è¯¥äº§å“ä¸‹æŒ‡å®šåˆ†ç»„çš„è®¾å¤‡",-1))]),l("div",bl,[e[54]||(e[54]=l("label",{class:"field-label"},[g(" é€‰æ‹©è®¾å¤‡ "),l("span",{class:"required"},"*")],-1)),l("div",gl,[l("div",vl,[a(Z,{modelValue:t.selectAll,"onUpdate:modelValue":e[15]||(e[15]=s=>t.selectAll=s),onChange:me},{default:i(()=>[...e[50]||(e[50]=[g(" å…¨é€‰/å–æ¶ˆå…¨é€‰ ",-1)])]),_:1},8,["modelValue"]),l("span",yl,[e[51]||(e[51]=g(" å·²é€‰æ‹© ",-1)),l("strong",null,v(t.selectedDeviceIds.length),1),e[52]||(e[52]=g(" å°è®¾å¤‡ ",-1)),t.configuredCount>0?(y(),U("span",_l," ï¼ˆå…¶ä¸­ "+v(t.configuredCount)+" å°å·²é…ç½®ï¼‰ ",1)):ae("",!0)])]),l("div",Vl,[(y(!0),U(O,null,j(t.availableDevices,s=>(y(),U("div",{key:s.id,class:$(["device-item",{"is-selected":s.selected}])},[a(Z,{modelValue:s.selected,"onUpdate:modelValue":w=>s.selected=w,onChange:G},null,8,["modelValue","onUpdate:modelValue"]),l("div",hl,[l("div",wl,[l("span",Cl,v(s.deviceName),1),s.alarmConfig?(y(),S(ge,{key:0,type:"success",size:"small"},{default:i(()=>[...e[53]||(e[53]=[g("å·²é…ç½®",-1)])]),_:1})):ae("",!0)]),l("div",Ul,[g(v(s.deviceCode)+" | "+v(s.groupName||"æœªåˆ†ç»„")+" | ",1),l("span",{class:$(s.status===1?"text-success":"text-gray")},v(s.status===1?"åœ¨çº¿":"ç¦»çº¿"),3)])])],2))),128))])])])]),e[64]||(e[64]=l("div",{class:"divider-line"},null,-1)),l("div",kl,[e[63]||(e[63]=l("h3",{class:"section-title"},"ç»Ÿä¸€é…ç½®",-1)),l("div",Il,[e[55]||(e[55]=l("label",{class:"field-label"},[g(" å¤„ç†äºº "),l("span",{class:"required"},"*")],-1)),a(p,{modelValue:t.form.notifyUser,"onUpdate:modelValue":e[16]||(e[16]=s=>t.form.notifyUser=s),placeholder:"è¯·é€‰æ‹©å¤„ç†äºº",class:"field-select-full"},{default:i(()=>[(y(!0),U(O,null,j(A.value,s=>(y(),S(u,{key:s.id,label:s.realName||s.username,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",El,[e[57]||(e[57]=l("label",{class:"field-label"},"æŠ¥è­¦å †å ",-1)),l("div",xl,[a(C,{modelValue:t.form.stackMode,"onUpdate:modelValue":e[17]||(e[17]=s=>t.form.stackMode=s)},null,8,["modelValue"]),e[56]||(e[56]=l("span",{class:"switch-label"},"å¼€å¯åï¼Œæ¢å¤å‰ä¸ä¼šé‡å¤æŠ¥è­¦",-1))])]),l("div",Ml,[e[59]||(e[59]=l("label",{class:"field-label"},"é‚®ä»¶é€šçŸ¥",-1)),l("div",Sl,[a(C,{modelValue:t.form.mailEnabled,"onUpdate:modelValue":e[18]||(e[18]=s=>t.form.mailEnabled=s)},null,8,["modelValue"]),e[58]||(e[58]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€é‚®ä»¶é€šçŸ¥å¤„ç†äºº",-1))])]),l("div",Dl,[e[61]||(e[61]=l("label",{class:"field-label"},"çŸ­ä¿¡é€šçŸ¥",-1)),l("div",Nl,[a(C,{modelValue:t.form.smsEnabled,"onUpdate:modelValue":e[19]||(e[19]=s=>t.form.smsEnabled=s)},null,8,["modelValue"]),e[60]||(e[60]=l("span",{class:"switch-label"},"å¼€å¯åï¼ŒæŠ¥è­¦æ—¶å°†å‘é€çŸ­ä¿¡é€šçŸ¥å¤„ç†äººï¼ˆæš‚æœªå®ç°ï¼‰",-1))])]),l("div",Ol,[e[62]||(e[62]=l("label",{class:"field-label"},[g(" ç‰©æ¨¡å‹ç›‘æ§é…ç½® "),l("span",{class:"required"},"*")],-1)),a(I,{data:B.value,border:"",style:{width:"100%"},"max-height":"300px"},{default:i(()=>[a(r,{prop:"attrName",label:"å±æ€§åç§°",width:"120"}),a(r,{label:"å¯ç”¨",width:"70",align:"center"},{default:i(({row:s})=>[a(C,{modelValue:t.form.metrics[s.addr].enabled,"onUpdate:modelValue":w=>t.form.metrics[s.addr].enabled=w,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(r,{label:"è¿ç®—ç¬¦",width:"100"},{default:i(({row:s})=>[a(p,{modelValue:t.form.metrics[s.addr].operator,"onUpdate:modelValue":w=>t.form.metrics[s.addr].operator=w,disabled:!t.form.metrics[s.addr].enabled,size:"small"},{default:i(()=>[a(u,{label:">",value:">"}),a(u,{label:"<",value:"<"}),a(u,{label:"=",value:"="})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(r,{label:"é˜ˆå€¼",width:"140"},{default:i(({row:s})=>[a(X,{modelValue:t.form.metrics[s.addr].threshold,"onUpdate:modelValue":w=>t.form.metrics[s.addr].threshold=w,disabled:!t.form.metrics[s.addr].enabled,precision:2,step:.1,size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(r,{label:"å•ä½",width:"80",align:"center"},{default:i(({row:s})=>[l("span",jl,v(s.unit||"-"),1)]),_:1}),a(r,{label:"æŠ¥è­¦çº§åˆ«",width:"140"},{default:i(({row:s})=>[a(p,{modelValue:t.form.metrics[s.addr].level,"onUpdate:modelValue":w=>t.form.metrics[s.addr].level=w,disabled:!t.form.metrics[s.addr].enabled,size:"small"},{default:i(()=>[a(u,{label:"ğŸ”´ ä¸¥é‡",value:"critical"}),a(u,{label:"ğŸŸ¡ è­¦å‘Š",value:"warning"}),a(u,{label:"ğŸ”µ æç¤º",value:"info"})]),_:1},8,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["data"])])])])]),_:1},8,["modelValue"])])}}},Gl=ye(Al,[["__scopeId","data-v-df5f14f1"]]);export{Gl as default};
