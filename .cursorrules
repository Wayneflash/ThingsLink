# IoT物联网设备管理平台开发规约

> Vue 3 + Spring Boot + MySQL + EMQX (MQTT) + Redis
> 支持1W设备并发，167条/秒写入量，基于设备分组的数据权限体系

---

## 🎯 核心原则

### 0. 开发流程规范 ⚠️⚠️⚠️⚠️⚠️（最高优先级）
1. **功能开发前必须生成方案原型**
   - 每次开发新功能前，必须先生成详细的开发方案原型
   - 方案原型必须包含：功能描述、涉及的文件清单、修改内容说明、影响范围分析
   - 方案原型保存在 `plans/` 目录，命名格式：`XXX-功能名称.md`
   - **必须等待用户确认方案后才能开始开发**

2. **修改前必须先确认**
   - 开发新功能或修复功能时，必须先明确列出要修改的文件清单
   - 必须说明每个文件的修改内容、修改原因、影响范围
   - **必须等待用户确认"OK"后才能开始修改代码**
   - 禁止未经确认就直接修改代码

3. **保护原有功能**
   - 新开发功能不能影响原有功能的正常运行
   - 修改现有文件时，必须保持原有功能逻辑不变
   - 新增功能必须独立实现，避免与原有代码耦合
   - 如果必须修改原有代码，必须先分析影响范围，并获得用户确认

4. **影响范围评估**
   - 修改代码前必须分析影响范围（哪些功能可能受影响）
   - 修改后端接口时，必须评估是否影响前端调用
   - 修改前端组件时，必须评估是否影响其他页面
   - 修改数据库结构时，必须评估是否影响现有业务逻辑

### 1. 修改优先级 ⚠️⚠️⚠️
1. **优先修改前端** - 能前端解决的问题，不要动后端
2. **后端修改需询问** - 必须修改后端时，先询问用户确认
3. **保持后端稳定** - 不要为了解决问题就乱改后端

### 2. UI/UX 设计规范 ⚠️⚠️⚠️（最高优先级）

#### 2.0 UI/UX 工作流（执行流程）

当用户请求 UI/UX 相关工作（设计、构建、审查、修复、改进）时，必须执行以下流程：

**第一步：需求分析 (Analyze User Requirements)**
从用户请求中提取：
- **Product type**: 产品类型（SaaS、仪表盘、门户、物联网平台等）
- **Style keywords**: 视觉风格（极简、专业、科技感、Apple风格等）
- **Industry**: 行业领域（金融、医疗、物联网、工业等）

**第二步：生成设计系统 (Generate Design System - REQUIRED)**
在编写任何 Vue 代码前，**必须**运行搜索脚本以获取基于数据驱动的设计建议。请注意，脚本路径和参数必须保持英文原样：
```bash
# 示例：python3 .shared/ui-ux-pro-max/scripts/search.py "iot dashboard industrial professional" --design-system --stack vue
python3 .shared/ui-ux-pro-max/scripts/search.py "<product_type> <industry> <keywords>" --design-system --stack vue
```
如果项目中没有该脚本，则参考现有的设计系统规范（Apple风格 + 物联网平台配色）。

**第三步：详细域搜索 (Supplement with Detailed Searches - as needed)**
获取设计系统后，可使用域搜索获取更多详细信息。`--domain` 后的参数必须保持英文原词：
- **图表建议 (Chart)**: `python3 .shared/ui-ux-pro-max/scripts/search.py "real-time dashboard" --domain chart`
- **交互规范 (UX)**: `python3 .shared/ui-ux-pro-max/scripts/search.py "complex form validation" --domain ux`
- **样式细节 (Style)**: `python3 .shared/ui-ux-pro-max/scripts/search.py "glassmorphism dark" --domain style`

**可用域 (Available Domains)**：
- `product`: 产品类型建议（SaaS, e-commerce, portfolio, healthcare, beauty, service）
- `style`: UI 样式、颜色、效果（glassmorphism, minimalism, dark mode, brutalism）
- `typography`: 字体配对、Google Fonts（elegant, playful, professional, modern）
- `color`: 按产品类型的配色方案（saas, ecommerce, healthcare, beauty, fintech, service）
- `landing`: 页面结构、CTA 策略（hero, hero-centric, testimonial, pricing, social-proof）
- `chart`: 图表类型、库建议（trend, comparison, timeline, funnel, pie）
- `ux`: 最佳实践、反模式（animation, accessibility, z-index, loading）
- `web`: Web 界面指南（aria, focus, keyboard, semantic, virtualize）
- `prompt`: AI 提示词、CSS 关键词（样式名称）

**可用技术栈 (Available Stacks)**：
- `html-tailwind`: Tailwind 工具类、响应式、a11y（默认）
- `vue`: Composition API、Pinia、Vue Router（本项目使用）
- `react`: 状态、Hooks、性能、模式
- `nextjs`: SSR、路由、图片、API 路由
- `svelte`: Runes、stores、SvelteKit
- `swiftui`: Views、State、Navigation、Animation
- `react-native`: Components、Navigation、Lists
- `flutter`: Widgets、State、Layout、Theming
- `shadcn`: shadcn/ui 组件、主题、表单、模式

#### 2.1 技术栈锁定（强制遵守）
| 维度 | 技术选型 | 版本要求 | 说明 |
| :--- | :--- | :--- | :--- |
| **核心框架** | Vue 3 (Composition API / `<script setup>`) | 3.3.4+ | 必须使用 `<script setup>` 语法 |
| **UI 组件库** | Element Plus (优先使用 el- 组件) | 2.3.14+ | 禁止使用原生 HTML 元素替代 |
| **CSS 框架** | Tailwind CSS (Utility-first 模式) | 4.1.18+ | 必须使用 Tailwind 工具类 |
| **图表库** | ECharts | 5.4.3+ | 数据可视化统一使用 ECharts |
| **图标库** | Element Plus Icons / Lucide Vue Next | - | **严禁使用 Emoji 作为 UI 图标** |

#### 2.2 设计系统（Apple风格）

**配色方案**：
- **主色**：`#007aff` (iOS蓝) / `#667eea` (侧边栏渐变起始色)
- **渐变色**：`linear-gradient(135deg, #667eea 0%, #764ba2 100%)` (菜单激活、按钮等)
- **成功色**：`#34c759`
- **警告色**：`#ff9500`
- **危险色**：`#ff3b30`
- **背景色**：页面 `#f5f5f7`，卡片 `#ffffff`
- **文字色**：主文字 `#1d1d1f`，次要文字 `#86868b`

**字体规范**：
- **字体栈**：`-apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif`
- **行高**：正文 1.5-1.6，标题 1.2-1.3
- **字重**：标题 600-700，正文 400-500

**间距规范**：
- **基准单位**：8px 的倍数
- **常用间距**：8px, 16px, 24px, 32px, 40px, 48px
- **容器最大宽度**：`max-w-7xl` 或自定义全局限制

**圆角规范**：
- **小圆角**：6px（按钮、标签）
- **中圆角**：10px-12px（输入框、卡片）
- **大圆角**：16px-20px（大卡片、模态框）
- **超大圆角**：24px（特殊装饰元素）

**阴影规范**：
- **轻阴影**：`0 1px 3px rgba(0, 0, 0, 0.04)`
- **中阴影**：`0 4px 12px rgba(0, 0, 0, 0.08)`
- **重阴影**：`0 8px 24px rgba(0, 0, 0, 0.12)`
- **卡片阴影**：`0 2px 8px rgba(0, 0, 0, 0.06)`

#### 2.3 专业 UI 准则（必须遵守）

以下是一些经常被忽视但会让 UI 看起来不专业的问题，必须严格遵守：

**1. 视觉质量与图标 (Icons & Visual Elements)**：
- ❌ **禁用 Emoji**: UI 图标必须使用 SVG 组件（如 Heroicons、Lucide），严禁使用 🚀 ⚙️ 等表情符号作为 UI 图标
- ✅ **Element Plus 增强**: 不要直接使用 `el-button` 的默认样式，必须通过 Tailwind 增加阴影、缩放等细节（如 `hover:shadow-md transition-transform`）
- ✅ **中文排版**: 必须优化中文字体声明，包含 `PingFang SC, Microsoft YaHei`，并保持行高在 1.6 左右
- ✅ **稳定悬停状态**: 在悬停时使用颜色/不透明度过渡，避免使用导致布局移动的缩放变换
- ✅ **一致的图标尺寸**: 使用固定的 viewBox (24x24) 配合 `w-6 h-6`，避免随机混合不同图标尺寸

**2. 交互与反馈 (Interaction & Cursor)**：
- ✅ **手形光标**: 为所有可点击/可悬停的卡片、元素显式添加 `cursor-pointer`
- ✅ **悬停反馈**: 必须提供清晰的视觉反馈（颜色、阴影、边框），明确元素可交互
- ✅ **平滑过渡**: 所有颜色、投影、位移变化必须添加 `transition-all duration-300`，避免即时状态更改或过慢（>500ms）

**3. 布局与间距 (Layout & Spacing)**：
- ✅ **悬浮导航**: 推荐使用 `top-4 left-4 right-4` 的悬浮式导航栏，并配合 `backdrop-blur-md` 效果，同时考虑内容填充避免遮挡
- ✅ **容器一致性**: 严格使用相同的 `max-w-6xl` 或 `max-w-7xl` 等自定义全局宽度限制，确保视觉重心集中

**4. 文字与对比度 (Text & Contrast)**：
- ✅ **亮色模式文字对比度**: 主文字至少 4.5:1（使用 `#1d1d1f` 而非 `#94A3B8`）
- ✅ **次要文字**: 至少使用 `#475569` (slate-600)，禁用 `#94A3B8` (slate-400)

**5. 毛玻璃效果 (Glassmorphism - 如适用)**：
- ✅ **亮色模式**: 使用 `bg-white/80` 或更高不透明度，禁用 `bg-white/10`
- ✅ **边框可见性**: 亮色模式使用 `border-gray-200`，禁用 `border-white/10`

#### 2.4 响应式设计

- ✅ **断点**：`640px` (sm), `768px` (md), `1024px` (lg), `1280px` (xl), `1920px` (2xl)
- ✅ **移动端适配**：确保在 375px、768px、1024px、1440px 下正常显示
- ✅ **1920×1080 适配**：关键页面（如登录页）必须在一屏内完整显示，考虑浏览器标签页高度（约40px）

#### 2.5 可访问性 (A11y)

- ✅ **图片**：必须包含 `alt` 属性
- ✅ **表单**：所有输入框必须有对应的 `label`
- ✅ **键盘导航**：支持 Tab 键导航，焦点状态可见
- ✅ **动画降级**：尊重 `prefers-reduced-motion`，提供动画禁用选项
- ✅ **颜色对比度**：确保文字与背景对比度符合 WCAG 2.1 AA 标准（4.5:1）

#### 2.6 图表与数据可视化（ECharts）

- ✅ **响应式**：必须包含 `window.addEventListener('resize', ...)` 处理窗口大小变化
- ✅ **配色统一**：图表配色必须符合设计系统的配色方案
- ✅ **交互反馈**：图表元素应具备适当的 hover 效果

#### 2.7 交付前自检清单（AI 必须完成）

在输出最终 Vue 代码前，AI 必须完成以下所有项目的自检：

**Visual Quality (视觉质量)**
- [ ] 未使用表情符号作为图标（已替换为 SVG）
- [ ] 所有图标来自一致的图标集 (Heroicons/Lucide/Element Plus Icons)
- [ ] 品牌 Logo 正确（如适用，已从 Simple Icons 验证）
- [ ] 悬停状态不会导致布局移动
- [ ] 直接使用主题颜色，不使用 `var()` 包装（除非必要）

**Interaction (交互)**
- [ ] 所有可点击元素都有 `cursor-pointer`
- [ ] 悬停状态提供清晰的视觉反馈
- [ ] 过渡平滑 (150-300ms)
- [ ] 键盘导航的焦点状态可见

**Light/Dark Mode (亮色/暗色模式对比度)**
- [ ] 亮色模式下文本对比度足够 (至少 4.5:1)
- [ ] 亮色模式下玻璃/透明元素可见
- [ ] 两种模式下边框都可见
- [ ] 交付前测试两种模式（如适用）

**Layout (布局)**
- [ ] 悬浮元素与边缘有适当的间距
- [ ] 没有内容隐藏在固定导航栏后面
- [ ] 在 375px、768px、1024px、1440px、1920px 均响应式
- [ ] 移动端没有水平滚动

**Accessibility (无障碍)**
- [ ] 所有图片都有 `alt` 文本
- [ ] 表单输入有标签
- [ ] 颜色不是唯一的指示器
- [ ] 尊重 `prefers-reduced-motion`

**Technical (技术规范)**
- [ ] Vue 规范：代码是否为 Vue 3 SFC 格式且包含 `<script setup>`？
- [ ] 组件复用：是否优先调用了 Element Plus 组件而非原生 HTML？
- [ ] ECharts 响应式：图表组件是否包含了窗口 resize 监听逻辑？
- [ ] 间距规范：是否使用了 8px 的倍数作为间距？
- [ ] 技术栈：是否使用了 Vue 3 + Element Plus + Tailwind CSS？

#### 2.8 前置条件与参考 (Prerequisites & Reference)

**前置条件 (Prerequisites)**：
- 运行搜索脚本前，需要确保已安装 Python 3
- 检查命令：`python3 --version || python --version`
- 如果未安装，根据操作系统安装：
  - macOS: `brew install python3`
  - Ubuntu/Debian: `sudo apt update && sudo apt install python3`
  - Windows: `winget install Python.Python.3.12`

**示例 Prompt (开发者参考)**：
```
@ui-ux-pro-max.md 请帮我做一个项目：

1. 运行设计搜索脚本，匹配一套适合'智慧能源管理系统'的深色模式调色盘
2. 使用 Vue 3 + Element Plus + ECharts 编写一个数据大屏卡片
3. 确保图表配色符合设计系统，且组件具备毛玻璃质感
```

### 3. 数据权限（全局统一）
- **超级管理员**：查看所有数据（不过滤）
- **普通用户**：只能查看本分组及下级分组数据
- **过滤字段**：用户表、设备表、告警日志表都使用 `group_id` 过滤

### 4. API接口规范
- 统一POST方法，JSON格式
- 统一响应：`{code, message, data}`
- **禁止前端硬编码业务数据**，必须从后端API获取

### 5. 分组组件（强制统一）
- 下拉选择：使用 `GroupSelector` 组件
- 树形展示：使用 `GroupTree` 组件
- **禁止重复实现分组功能**

### 6. 性能要求
- 列表查询 < 500ms
- 必须分页查询，禁止一次性加载
- 禁止循环中执行数据库操作
- MQTT消息异步处理

---

## ✅ 必须遵守的规则

### API文档管理规则 ⚠️⚠️⚠️（最高优先级）
```
⚠️ 所有API接口变更必须先更新API文档，再进行开发！

📁 API文档位置：docs/API.md

🔥 核心原则（必须遵守）：
   1. 开发新功能前，必须先更新API文档
   2. API文档必须包含完整的接口定义（请求参数、响应格式、权限说明）
   3. 修改现有接口时，必须先更新API文档中的接口定义
   4. API文档更新后，必须等待用户确认"OK"才能开始开发
   5. 开发完成后，必须验证API文档与实际接口的一致性

🔹 新增API接口时：
   1. ✅ 必须在 docs/API.md 中新增接口文档
   2. 文档必须包含：
      - 接口路径和方法
      - 请求参数（必填/可选、类型、说明）
      - 响应格式（成功/失败示例）
      - 权限说明（是否需要认证、权限要求）
      - 特殊说明（如有）
   3. 按照文档中的格式和风格编写
   4. 等待用户确认API文档后，再开始开发

🔹 修改现有API接口时：
   1. ✅ 必须先更新 docs/API.md 中对应的接口文档
   2. 明确标注变更内容（新增字段、修改字段、删除字段）
   3. 说明变更原因和影响范围
   4. 等待用户确认API文档变更后，再开始修改代码

🔹 API文档格式要求：
   - 使用Markdown格式
   - 接口按模块分类组织
   - 每个接口包含完整的请求/响应示例
   - 使用表格、代码块等提高可读性
   - 保持文档的专业性和可视化

⚠️ API文档更新后的步骤：
   1. 更新 docs/API.md
   2. 展示给用户确认
   3. 等待用户确认"OK"
   4. 生成开发方案原型（plans/XXX-功能名称.md）
   5. 等待用户确认方案
   6. 开始开发
   7. 开发完成后验证API文档与实际接口的一致性
```

### 开发流程（严格执行）
```
⚠️ 开发新功能或修复功能时的标准流程：

1. 更新API文档（如涉及API接口）
   → 更新 docs/API.md
   → 详细说明接口定义、请求参数、响应格式
   → 等待用户确认API文档"OK"
   
2. 生成方案原型
   → 创建 plans/XXX-功能名称.md 文件
   → 详细说明：功能描述、文件清单、修改内容、影响范围
   
3. 等待用户确认
   → 展示方案给用户
   → 等待用户确认"OK"或提出修改意见
   
4. 列出修改清单
   → 明确列出要修改的文件路径
   → 说明每个文件的修改内容和原因
   
5. 再次确认
   → 等待用户确认"OK"后才能开始修改
   
6. 开始开发
   → 按照确认的方案进行开发
   → 确保不影响原有功能
   → 开发完成后验证API文档与实际接口的一致性
```

### 后端修改后自动编译
```
修改后端代码后，执行：cd backend && mvn package -DskipTests
编译完成后提醒用户重启后端服务
```

### 设备列表排序
```sql
ORDER BY status DESC, create_time DESC  -- 在线优先，时间降序
```

### 弹窗设计
- 内容在视窗内完整显示，最大高度96vh
- 禁止出现滚动条（列表区域除外）

### 时间格式
```
格式：yyyy-MM-dd HH:mm:ss
示例：2026-01-10 08:42:49
禁止：ISO 8601格式（带T的格式）
```

### 脚本编写规则 ⚠️⚠️⚠️
```
⚠️ 所有脚本必须支持在不同电脑上运行，禁止硬编码绝对路径！

📁 脚本目录：scripts/
🔹 脚本开头必须使用相对路径：
   @echo off
   setlocal enabledelayedexpansion
   chcp 65001 >nul
   
   REM 获取脚本所在目录（自动适配不同路径）
   set SCRIPT_DIR=%~dp0
   set SCRIPT_DIR=!SCRIPT_DIR:~0,-1!
   
   REM 切换到项目根目录
   cd /d "!SCRIPT_DIR!\.."

🔹 配置信息放在单独的配置文件：
   - 配置文件：scripts/deploy-config.txt
   - 模板文件：scripts/deploy-config.template.txt
   - 配置文件不提交到Git（已在.gitignore中）

🔹 危险操作必须二次确认：
   - Git pull/push 等会覆盖代码的操作
   - 删除文件/目录的操作
   - 需要先显示当前状态，让用户知道会影响什么
   - 使用 set /p CONFIRM="确认？(Y/N): " 获取用户确认

❌ 禁止行为：
   - 硬编码绝对路径（如 D:\AICoding\IOT）
   - 硬编码用户名、密码到脚本中
   - 依赖特定电脑的环境变量
   - 危险操作不经确认直接执行
```

### 数据库迁移规则 ⚠️⚠️⚠️（最高优先级）
```
⚠️ 数据库结构变更必须通过迁移脚本管理，保护生产数据的安全！

📁 迁移脚本目录：sql/migrations/
📋 服务器现有表（15张）：
   - system_config, tb_alarm_log, tb_attribute, tb_command, tb_command_log
   - tb_device, tb_device_data, tb_device_group, tb_device_log, tb_menu
   - tb_migration_history, tb_notification, tb_product, tb_role, tb_user

🔥 核心原则（必须遵守）：
   1. 所有新建表必须放在 sql/migrations/ 目录
   2. 迁移脚本必须是幂等的（可重复执行）
   3. 只能新增字段/表，绝不删除或修改现有字段
   4. 不能影响远端数据库的现有数据
   5. 同步到生产环境前必须在本地测试

🔹 新增功能需要新建表时：
   1. ✅ 必须在 sql/migrations/ 目录创建迁移脚本
   2. 文件命名：XXX_功能描述.sql（如：003_create_device_data_table.sql）
   3. ✅ 必须使用 CREATE TABLE IF NOT EXISTS 语法（幂等性）
   4. 添加迁移历史记录（见示例）
   5. 示例：
      CREATE TABLE IF NOT EXISTS `tb_new_table` (
          `id` BIGINT AUTO_INCREMENT PRIMARY KEY,
          `name` VARCHAR(100) NOT NULL,
          `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP,
          PRIMARY KEY (`id`)
      ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='新表说明';
      
      -- 记录迁移历史
      INSERT INTO tb_migration_history (migration_file, status, executed_at) 
      VALUES ('003_create_new_table.sql', 'success', NOW())
      ON DUPLICATE KEY UPDATE status = 'success', executed_at = NOW();

🔹 现有表需要新增字段时（只能新增，不能删除/修改）：
   1. ✅ 必须在 sql/migrations/ 目录创建迁移脚本
   2. ✅ 必须使用安全的 ALTER TABLE 语法，先检查字段是否存在（幂等性）
   3. ✅ 只能 ADD COLUMN，绝不 DROP COLUMN 或 MODIFY COLUMN
   4. 新字段必须允许 NULL 或有默认值（不影响现有数据）
   5. 示例：
      -- 检查字段是否已存在
      SET @exist := (SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS 
                     WHERE TABLE_SCHEMA = DATABASE() 
                     AND TABLE_NAME = 'tb_device' 
                     AND COLUMN_NAME = 'new_field');
      
      -- 只在不存在时添加
      SET @sql := IF(@exist = 0, 
          'ALTER TABLE tb_device ADD COLUMN new_field VARCHAR(100) DEFAULT NULL COMMENT ''新字段说明''', 
          'SELECT ''Field already exists'' AS message');
      
      PREPARE stmt FROM @sql;
      EXECUTE stmt;
      DEALLOCATE PREPARE stmt;
      
      -- 记录迁移历史
      INSERT INTO tb_migration_history (migration_file, status, executed_at) 
      VALUES ('004_add_device_field.sql', 'success', NOW())
      ON DUPLICATE KEY UPDATE status = 'success', executed_at = NOW();

🔹 新增索引时：
   -- MySQL 5.7+ 支持 IF NOT EXISTS
   CREATE INDEX IF NOT EXISTS `idx_xxx` ON `tb_xxx` (`field`);
   
   -- 或使用安全检查
   SET @exist := (SELECT COUNT(*) FROM INFORMATION_SCHEMA.STATISTICS
                  WHERE TABLE_SCHEMA = DATABASE()
                  AND TABLE_NAME = 'tb_xxx'
                  AND INDEX_NAME = 'idx_xxx');
   SET @sql := IF(@exist = 0, 
       'CREATE INDEX idx_xxx ON tb_xxx (field)', 
       'SELECT ''Index already exists''');
   PREPARE stmt FROM @sql;
   EXECUTE stmt;
   DEALLOCATE PREPARE stmt;

❌ 绝对禁止的操作（会导致数据丢失或生产事故）：
   - DROP TABLE（删除表）❌
   - TRUNCATE TABLE（清空表）❌
   - DELETE FROM（删除数据）❌
   - DROP COLUMN（删除字段）❌
   - ALTER COLUMN / MODIFY COLUMN（修改字段类型/约束）❌
   - 不带 IF NOT EXISTS 的 CREATE TABLE ❌
   - 直接写 ALTER TABLE ADD COLUMN 不检查是否存在 ❌

⚠️ 迁移脚本编写后的步骤：
   1. 同步更新后端Entity类（如有新表/新字段）
   2. 同步更新后端Mapper（如有新字段）
   3. 本地测试：运行 scripts/sync-db.bat（输入 N 跳过远程）
   4. 验证功能正常后，提醒用户同步到生产环境
   5. 生产同步：运行 scripts/sync-db.bat（输入 Y 同步远程）

🔹 同步脚本使用：
   scripts/sync-db.bat
   - 自动同步本地数据库
   - 询问是否同步远程（Y/N）
   - 幂等设计，可重复执行
   - 不会影响现有数据
```

---

## 📁 关键文件位置

| 类型 | 路径 |
|------|------|
| API文档 | `docs/API.md` |
| 数据库迁移 | `sql/migrations/` |
| 前端API | `frontend/src/api/` |
| 分组组件 | `frontend/src/components/GroupSelector.vue`、`GroupTree.vue` |
| 数据权限 | `backend/.../controller/DeviceController.java` |
| MQTT配置 | `backend/.../mqtt/MqttConfig.java` |
| 数据库同步 | `scripts/sync-db.bat` |

---

## ❌ 禁止行为

- **未经确认直接修改代码** - 必须先生成方案并获得用户确认
- **开发新API接口前不更新API文档** - 必须先更新 docs/API.md 并获得用户确认
- **修改现有API接口前不更新API文档** - 必须先更新API文档中的接口定义
- **修改代码前不分析影响范围** - 必须评估对原有功能的影响
- **破坏原有功能逻辑** - 新功能开发必须保证原有功能正常运行
- 前端硬编码业务数据
- 不同接口使用不同权限逻辑
- 跳过数据权限检查
- 全表扫描、未分页查询
- 同步处理MQTT消息
- DROP/TRUNCATE/DELETE 生产数据

---

*最后更新：2026-01-13*  
*新增：API文档管理规则*
